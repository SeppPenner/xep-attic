<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>JEP-0066: Out of Band Data</title>
<link rel="stylesheet" type="text/css" href="jep.css">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico">
<meta name="DC.Title" content="Out of Band Data">
<meta name="DC.Creator" content="Peter Saint-Andre">
<meta name="DC.Description" content="This JEP provides canonical documentation of the jabber:iq:oob and jabber:x:oob namespaces currently in use within the Jabber community.">
<meta name="DC.Publisher" content="Jabber Software Foundation">
<meta name="DC.Contributor" content="JEP Editor">
<meta name="DC.Date" content="2006-01-11">
<meta name="DC.Type" content="Jabber Enhancement Proposal">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="JEP-0066">
<meta name="DC.Language" content="en">
<meta name="DC.Rights" content="This Jabber Enhancement Proposal is copyright 1999 - 2005 by the Jabber Software Foundation (JSF) and is in full conformance with the JSF's Intellectual Property Rights Policy &lt;http://www.jabber.org/jsf/ipr-policy.shtml&gt;. This material may be distributed only subject to the terms and conditions set forth in the Creative Commons Attribution License (&lt;http://creativecommons.org/licenses/by/2.5/&gt;).">
</head>
<body>
<h1>JEP-0066: Out of Band Data</h1>
<p>This JEP provides canonical documentation of the jabber:iq:oob and jabber:x:oob namespaces currently in use within the Jabber community.</p>
<p><hr></p>
<p style="color:green">NOTICE: This Historical JEP provides canonical documentation of a protocol that is in use within the Jabber/XMPP community. This JEP is not a standards-track specification within the Jabber Software Foundation's standards process; however, it may be converted to standards-track in the future or may be obsoleted by a more modern protocol.</p>
<p><hr></p>
<h2>JEP Information</h2>
<p class="indent">
            Status: Active<br>
            Type: Historical<br>
            Number: 0066<br>
            Version: 1.4<br>
            Last Updated: 2006-01-11<br>
            JIG: Standards JIG<br>
                Approving Body: Jabber Council<br>Dependencies: XMPP Core<br>
                Supersedes: None<br>
                Superseded By: None<br>
            Short Name: oob<br>
        Schema for jabber:iq:oob: &lt;<a href="http://jabber.org/protocol/oob/iq-oob.xsd">http://jabber.org/protocol/oob/iq-oob.xsd</a>&gt;<br>
        Schema for jabber:x:oob: &lt;<a href="http://jabber.org/protocol/oob/x-oob.xsd">http://jabber.org/protocol/oob/x-oob.xsd</a>&gt;<br>
              Wiki Page: &lt;<a href="http://wiki.jabber.org/index.php/Out%20of%20Band%20Data%20(JEP-0066)">http://wiki.jabber.org/index.php/Out of Band Data (JEP-0066)</a>&gt;
            </p>
<h2>Author Information</h2>
<div class="indent">
<h3>Peter Saint-Andre</h3>
<p class="indent">
        Email: stpeter@jabber.org<br>
        JID: stpeter@jabber.org</p>
</div>
<h2>Legal Notice</h2>
<p class="indent">This Jabber Enhancement Proposal is copyright 1999 - 2005 by the <a href="http://www.jabber.org/jsf/">Jabber Software Foundation</a> (JSF) and is in full conformance with the JSF's Intellectual Property Rights Policy &lt;<a href="http://www.jabber.org/jsf/ipr-policy.shtml">http://www.jabber.org/jsf/ipr-policy.shtml</a>&gt;. This material may be distributed only subject to the terms and conditions set forth in the Creative Commons Attribution License (&lt;<a href="http://creativecommons.org/licenses/by/2.5/">http://creativecommons.org/licenses/by/2.5/</a>&gt;).</p>
<h2>Discussion Venue</h2>
<p class="indent">The preferred venue for discussion of this document is the Standards-JIG discussion list: &lt;<a href="http://mail.jabber.org/mailman/listinfo/standards-jig">http://mail.jabber.org/mailman/listinfo/standards-jig</a>&gt;.</p>
<h2>Relation to XMPP</h2>
<p class="indent">The Extensible Messaging and Presence Protocol (XMPP) is defined in the XMPP Core (RFC 3920) and XMPP IM (RFC 3921) specifications contributed by the Jabber Software Foundation to the Internet Standards Process, which is managed by the Internet Engineering Task Force in accordance with RFC 2026. Any protocol defined in this JEP has been developed outside the Internet Standards Process and is to be understood as an extension to XMPP rather than as an evolution, development, or modification of XMPP itself.</p>
<h2>Conformance Terms</h2>
<p class="indent">The keywords "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in RFC 2119.</p>
<p><hr></p>
<h2>Table of Contents</h2>
<div class="indent"><dl>
<dt>1.  <a href="#intro">Introduction</a>
</dt>
<dt>2.  <a href="#iq-oob">jabber:iq:oob</a>
</dt>
<dt>3.  <a href="#x-oob">jabber:x:oob</a>
</dt>
<dt>4.  <a href="#nonhttp">Use With Non-HTTP URI Schemes</a>
</dt>
<dt>5.  <a href="#si">Integration With Stream Initiation</a>
</dt>
<dt>6.  <a href="#security">Security Considerations</a>
</dt>
<dt>7.  <a href="#iana">IANA Considerations</a>
</dt>
<dt>8.  <a href="#registrar">Jabber Registrar Considerations</a>
</dt>
<dt>9.  <a href="#schemas">XML Schemas</a>
</dt>
<dl>
<dt>9.1.  <a href="#schemas-iq">jabber:iq:oob</a>
</dt>
<dt>9.2.  <a href="#schemas-x">jabber:x:oob</a>
</dt>
</dl>
<dt><a href="#notes">Notes</a></dt>
<dt><a href="#revs">Revision History</a></dt>
</dl></div>
<p><hr></p>
<h2>1.
       <a name="intro">Introduction</a>
</h2>
  <p class="" style="">This JEP documents the original mechanisms for out-of-band (OOB) data transfer as codified in the 'jabber:iq:oob' and 'jabber:x:oob' namespaces. This JEP is informational only and does not purport to recommend a Jabber standard.</p>
<h2>2.
       <a name="iq-oob">jabber:iq:oob</a>
</h2>
  <p class="" style="">The intent of the 'jabber:iq:oob' was to provide a "least common denominator" mechanism for basic file transfers in the early days of the Jabber open-source projects. The more advanced mechanisms defined in <span class="ref" style="">File Transfer</span>  [<a href="#nt-id2250581">1</a>] SHOULD be used, although the 'jabber:iq:oob' namespace can be included as one option during the file transfer negotiation since many older clients do not yet support other file transfer options such as those defined in <span class="ref" style="">SOCKS5 Bytestreams</span>  [<a href="#nt-id2250611">2</a>] and <span class="ref" style="">In-Band Bytestreams</span>  [<a href="#nt-id2250630">3</a>].</p>
  <p class="" style="">To initiate an out-of-band file transfer with an intended recipient using the 'jabber:iq:oob' namespace (whether or not negotiated via JEP-0096), the sending application sends an &lt;iq/&gt; of type 'set' to the recipient containing a &lt;query/&gt; child element qualified by the 'jabber:iq:oob' namespace; the &lt;query/&gt; MUST in turn contain a &lt;url/&gt; child specifying the URL of the file to be transferred, and MAY contain an optional &lt;desc/&gt; child describing the file. This usage is shown in the following example.</p>
    <p class="caption">Example 1. Sender Initiates Request-Response</p>
<div class="indent"><pre>
&lt;iq type='set'
    from='stpeter@jabber.org/work'
    to='MaineBoy@jabber.org/home'
    id='oob1'&gt;
  &lt;query xmlns='jabber:iq:oob'&gt;
    &lt;url&gt;http://www.jabber.org/images/psa-license.jpg&lt;/url&gt;
    &lt;desc&gt;A license to Jabber!&lt;/desc&gt;
  &lt;/query&gt;
&lt;/iq&gt;
    </pre></div>
    <p class="" style="">The expected result is for the recipient to retrieve the file via an HTTP GET request and to then inform the sender of successful receipt of the file. The receiving application MUST NOT send the IQ result until it has retrieved the complete file (e.g., it MUST NOT send the IQ result if it has merely attempted to retrieve the file or the URL provided seems to be valid):</p>
    <p class="caption">Example 2. Recipient Informs Sender of Success</p>
<div class="indent"><pre>
&lt;iq type='result'
    from='MaineBoy@jabber.org/home'
    to='stpeter@jabber.org/work'
    id='oob1'/&gt;
    </pre></div>
    <p class="" style="">If the recipient attempts to retrieve the file but is unable to do so, the receiving application MUST return an &lt;iq/&gt; of type 'error' to the sender specifying a Not Found condition:</p>
    <p class="caption">Example 3. Recipient Informs Sender of Failure</p>
<div class="indent"><pre>
&lt;iq type='error'
    from='MaineBoy@jabber.org/home'
    to='stpeter@jabber.org/work'
    id='oob1'&gt;
  &lt;query xmlns='jabber:iq:oob'&gt;
    &lt;url&gt;http://www.jabber.org/images/psa-license.jpg&lt;/url&gt;
    &lt;desc&gt;A license to Jabber!&lt;/desc&gt;
  &lt;/query&gt;
  &lt;error code='404' type='cancel'&gt;
    &lt;not-found xmlns='urn:ietf:params:xml:ns:xmpp-stanzas'/&gt;
  &lt;/error&gt;
&lt;/iq&gt;
    </pre></div>
    <p class="" style="">If the recipient rejects the request outright, the receiving application MUST return an &lt;iq/&gt; of type 'error' to the sender specifying a Not Acceptable condition:</p>
    <p class="caption">Example 4. Recipient Rejects Request</p>
<div class="indent"><pre>
&lt;iq type='error'
    from='MaineBoy@jabber.org/home'
    to='stpeter@jabber.org/work'
    id='oob1'&gt;
  &lt;query xmlns='jabber:iq:oob'&gt;
    &lt;url&gt;http://www.jabber.org/images/psa-license.jpg&lt;/url&gt;
    &lt;desc&gt;A license to Jabber!&lt;/desc&gt;
  &lt;/query&gt;
  &lt;error code='406' type='modify'&gt;
    &lt;not-acceptable xmlns='urn:ietf:params:xml:ns:xmpp-stanzas'/&gt;
  &lt;/error&gt;
&lt;/iq&gt;
    </pre></div>
<h2>3.
       <a name="x-oob">jabber:x:oob</a>
</h2>
  <p class="" style="">The 'jabber:x:oob' namespace was not intended for use in file transfers, since the lack of a request-response semantic prevents the recipient from programatically confirming receipt of the file or communicating errors (if these features are needed, an application should use the 'jabber:iq:oob' namespace and/or the stream initiation profile defined in JEP-0096). However, the 'jabber:x:oob' namespace is useful for communicating a URL to other users or applications. This is done by including an &lt;x/&gt; child element qualified by the 'jabber:x:oob' namespace in either a &lt;message/&gt; and &lt;presence/&gt; stanza; the &lt;x/&gt; child MUST contain a &lt;url/&gt; child specifying the URL of the resource, and MAY contain an optional &lt;desc/&gt; child describing the resource.</p>
    <p class="caption">Example 5. Sender Communicates a URI</p>
<div class="indent"><pre>
&lt;message from='stpeter@jabber.org/work'
         to='MaineBoy@jabber.org/home'&gt;
  &lt;body&gt;Yeah, but do you have a license to Jabber?&lt;/body&gt;
  &lt;x xmlns='jabber:x:oob'&gt;
    &lt;url&gt;http://www.jabber.org/images/psa-license.jpg&lt;/url&gt;
  &lt;/x&gt;
&lt;/message&gt;
    </pre></div>
<h2>4.
       <a name="nonhttp">Use With Non-HTTP URI Schemes</a>
</h2>
  <p class="" style="">The value of the &lt;url/&gt; element is not limited to URIs that conform to the http: URI scheme (as specified by <span class="ref" style="">RFC 2616</span>  [<a href="#nt-id2250759">4</a>]). For example, file transfers could also be effected using ftp: URIs as (specified by <span class="ref" style="">RFC 959</span>  [<a href="#nt-id2256442">5</a>]). Going further afield, several existing Jabber clients use the callto: URI scheme to initiate voice conferencing via NetMeeting or GnomeMeeting. Other out-of-band communications could be initiated in a similar way via URI schemes such as sip: (as specified by <span class="ref" style="">RFC 3261</span>  [<a href="#nt-id2256465">6</a>]). All of these usages are allowed by the existing OOB namespaces, as long as the value of the &lt;url/&gt; element is a valid URI (as specified by <span class="ref" style="">RFC 3986</span>  [<a href="#nt-id2256488">7</a>]).</p>
<h2>5.
       <a name="si">Integration With Stream Initiation</a>
</h2>
  <p class="" style=""><span style="font-style: italic">This section is non-normative.</span></p>
  <p class="" style=""><span class="ref" style="">Stream Initiation</span>  [<a href="#nt-id2256528">8</a>] defines methods for negotiating content streams between any two entities, and JEP-0096 defines a profile of stream initiation for file transfer. Although the use of jabber:iq:oob is not recommended by JEP-0096, it could be offered as one option (e.g., a fallback if SOCKS5 Bytestreams and In-Band Bytestreams are not available). If so, the value of the feature negotiation option MUST be "jabber:iq:oob" and the &lt;query/&gt; element within the &lt;iq/&gt; stanza qualified by the 'jabber:iq:oob' namespace MUST possess a 'sid' attribute whose value is the StreamID negotiated by stream initiation.</p>
  <p class="" style="">A sample protocol flow is shown below.</p>
  <p class="caption">Example 6. Stream Initiation Offer</p>
<div class="indent"><pre>
    
&lt;iq type='set' 
    from='romeo@montague.net/orchard'
    to='juliet@capulet.com/chamber'
    id='offer1'&gt;
  &lt;si xmlns='http://jabber.org/protocol/si' 
      id='a0'
      mime-type='text/plain'
      profile='http://jabber.org/protocol/si/profile/file-transfer'&gt;
    &lt;file xmlns='http://jabber.org/protocol/si/profile/file-transfer'
          name='test.txt'
          size='1022'/&gt;
    &lt;feature xmlns='http://jabber.org/protocol/feature-neg'&gt;
      &lt;x xmlns='jabber:x:data' type='form'&gt;
        &lt;field var='stream-method' type='list-single'&gt;
          &lt;option&gt;&lt;value&gt;http://jabber.org/protocol/bytestreams&lt;/value&gt;&lt;/option&gt;
          &lt;option&gt;&lt;value&gt;http://jabber.org/protocol/ibb&lt;/value&gt;&lt;/option&gt;
          &lt;option&gt;&lt;value&gt;jabber:iq:oob&lt;/value&gt;&lt;/option&gt;
        &lt;/field&gt;
      &lt;/x&gt;
    &lt;/feature&gt;
  &lt;/si&gt;
&lt;/iq&gt;
    
  </pre></div>
  <p class="caption">Example 7. Stream Initiation Result</p>
<div class="indent"><pre>
    
&lt;iq type='result' 
    from='juliet@capulet.com/chamber'&gt;
    to='romeo@montague.net/orchard'
    id='offer1'&gt;
  &lt;si xmlns='http://jabber.org/protocol/si'
      id='a0'
      profile='http://jabber.org/protocol/si/profile/file-transfer'&gt;
    &lt;feature xmlns='http://jabber.org/protocol/feature-neg'&gt;
      &lt;x xmlns='jabber:x:data' type='submit'&gt;
        &lt;field var='stream-method'&gt;
          &lt;value&gt;jabber:iq:oob&lt;/value&gt;
        &lt;/field&gt;
      &lt;/x&gt;
    &lt;/feature&gt;
  &lt;/si&gt;
&lt;/iq&gt;
    
  </pre></div>
  <p class="caption">Example 8. Sender Initiates Request-Response</p>
<div class="indent"><pre>
&lt;iq type='set'
    from='romeo@montague.net/orchard'
    to='juliet@capulet.com/chamber'&gt;
    id='send1'&gt;
  &lt;query xmlns='jabber:iq:oob'
         sid='a0'&gt;
    &lt;url&gt;http://www.shakespeare.lit/files/letter.txt&lt;/url&gt;
  &lt;/query&gt;
&lt;/iq&gt;
  </pre></div>
  <p class="caption">Example 9. Recipient Informs Sender of Success</p>
<div class="indent"><pre>
&lt;iq type='result'
    from='juliet@capulet.com/chamber'&gt;
    to='romeo@montague.net/orchard'
    id='send1'/&gt;
  </pre></div>
<h2>6.
       <a name="security">Security Considerations</a>
</h2>
  <p class="" style="">As with any mechanism that communicates a URI, care must be taken by the receiving application to ensure that the resource retrieved does not contain harmful or malicious data (e.g., a virus-infected file).</p>
<h2>7.
       <a name="iana">IANA Considerations</a>
</h2>
  <p class="" style="">This JEP requires no interaction with the <span class="ref" style="">Internet Assigned Numbers Authority (IANA)</span>  [<a href="#nt-id2256679">9</a>].</p>
<h2>8.
       <a name="registrar">Jabber Registrar Considerations</a>
</h2>
  <p class="" style="">The 'jabber:iq:oob' and 'jabber:x:oob' namespaces are included in the protocol namespaces registry maintained by the <span class="ref" style="">Jabber Registrar</span>  [<a href="#nt-id2256719">10</a>].</p>
<h2>9.
       <a name="schemas">XML Schemas</a>
</h2>
  <div class="indent">
<h3>9.1 <a name="schemas-iq">jabber:iq:oob</a>
</h3>
    <p class="caption"></p>
<div class="indent"><pre>
&lt;?xml version='1.0' encoding='UTF-8'?&gt;

&lt;xs:schema
    xmlns:xs='http://www.w3.org/2001/XMLSchema'
    targetNamespace='jabber:iq:oob'
    xmlns='jabber:iq:oob'
    elementFormDefault='qualified'&gt;

  &lt;xs:annotation&gt;
    &lt;xs:documentation&gt;
      The protocol documented by this schema is defined in
      JEP-0066: http://www.jabber.org/jeps/jep-0066.html
    &lt;/xs:documentation&gt;
  &lt;/xs:annotation&gt;

  &lt;xs:element name='query'&gt;
    &lt;xs:complexType&gt;
      &lt;xs:sequence&gt;
        &lt;xs:element name='url' type='xs:string' minOccurs='1'/&gt;
        &lt;xs:element name='desc' type='xs:string' minOccurs='0'/&gt;
      &lt;/xs:sequence&gt;
      &lt;xs:attribute name='sid' type='xs:string' use='optional'/&gt;
    &lt;/xs:complexType&gt;
  &lt;/xs:element&gt;

&lt;/xs:schema&gt;
    </pre></div>
  </div>
  <div class="indent">
<h3>9.2 <a name="schemas-x">jabber:x:oob</a>
</h3>
    <p class="caption"></p>
<div class="indent"><pre>
&lt;?xml version='1.0' encoding='UTF-8'?&gt;

&lt;xs:schema
    xmlns:xs='http://www.w3.org/2001/XMLSchema'
    targetNamespace='jabber:x:oob'
    xmlns='jabber:x:oob'
    elementFormDefault='qualified'&gt;

  &lt;xs:annotation&gt;
    &lt;xs:documentation&gt;
      The protocol documented by this schema is defined in
      JEP-0066: http://www.jabber.org/jeps/jep-0066.html
    &lt;/xs:documentation&gt;
  &lt;/xs:annotation&gt;

  &lt;xs:element name='x'&gt;
    &lt;xs:complexType&gt;
      &lt;xs:sequence&gt;
        &lt;xs:element name='url' type='xs:string' minOccurs='1'/&gt;
        &lt;xs:element name='desc' type='xs:string' minOccurs='0'/&gt;
      &lt;/xs:sequence&gt;
    &lt;/xs:complexType&gt;
  &lt;/xs:element&gt;

&lt;/xs:schema&gt;
    </pre></div>
  </div>
<p><hr></p>
<a name="notes"></a><h2>Notes</h2>
<div class="indent">
<p><a name="nt-id2250581">1</a>. JEP-0096: File Transfer &lt;<a href="http://www.jabber.org/jeps/jep-0096.html">http://www.jabber.org/jeps/jep-0096.html</a>&gt;.</p>
<p><a name="nt-id2250611">2</a>. JEP-0065: SOCKS5 Bytestreams &lt;<a href="http://www.jabber.org/jeps/jep-0065.html">http://www.jabber.org/jeps/jep-0065.html</a>&gt;.</p>
<p><a name="nt-id2250630">3</a>. JEP-0047: In-Band Bytestreams &lt;<a href="http://www.jabber.org/jeps/jep-0047.html">http://www.jabber.org/jeps/jep-0047.html</a>&gt;.</p>
<p><a name="nt-id2250759">4</a>. RFC 2616: Hypertext Transport Protocol -- HTTP/1.1 &lt;<a href="http://www.ietf.org/rfc/rfc2616.txt">http://www.ietf.org/rfc/rfc2616.txt</a>&gt;.</p>
<p><a name="nt-id2256442">5</a>. RFC 959: File Transfer Protocol &lt;<a href="http://www.ietf.org/rfc/rfc0959.txt">http://www.ietf.org/rfc/rfc0959.txt</a>&gt;.</p>
<p><a name="nt-id2256465">6</a>. RFC 3261: Session Initiation Protocol (SIP) &lt;<a href="http://www.ietf.org/rfc/rfc3261.txt">http://www.ietf.org/rfc/rfc3261.txt</a>&gt;.</p>
<p><a name="nt-id2256488">7</a>. RFC 3986: Uniform Resource Identifiers (URI): Generic Syntax &lt;<a href="http://www.ietf.org/rfc/rfc3986.txt">http://www.ietf.org/rfc/rfc3986.txt</a>&gt;.</p>
<p><a name="nt-id2256528">8</a>. JEP-0095: Stream Initiation &lt;<a href="http://www.jabber.org/jeps/jep-0095.html">http://www.jabber.org/jeps/jep-0095.html</a>&gt;.</p>
<p><a name="nt-id2256679">9</a>. The Internet Assigned Numbers Authority (IANA) is the central coordinator for the assignment of unique parameter values for Internet protocols, such as port numbers and URI schemes. For further information, see &lt;<a href="http://www.iana.org/">http://www.iana.org/</a>&gt;.</p>
<p><a name="nt-id2256719">10</a>. The Jabber Registrar maintains a list of reserved Jabber protocol namespaces as well as registries of parameters used in the context of protocols approved by the Jabber Software Foundation. For further information, see &lt;<a href="http://www.jabber.org/registrar/">http://www.jabber.org/registrar/</a>&gt;.</p>
</div>
<p><hr></p>
<a name="revs"></a><h2>Revision History</h2>
<div class="indent">
<h4>Version 1.4 (2006-01-11)</h4>
<div class="indent">Removed example of including URL in presence stanza. (psa)
    </div>
<h4>Version 1.3 (2004-10-18)</h4>
<div class="indent">Added non-normative section on integration with stream initiation (JEP-0095); added optional sid attribute to jabber:iq:oob schema. (psa)
    </div>
<h4>Version 1.2 (2004-04-13)</h4>
<div class="indent">Clarified that IQ use is for basic file transfer whereas message and presence use is for communication of URIs; added presence example; added references to file transfer JEPs as well as related open issue. (psa)
    </div>
<h4>Version 1.1 (2004-02-10)</h4>
<div class="indent">Editorial adjustments and clarifications; added references to relevant RFCs. (psa)
    </div>
<h4>Version 1.0 (2003-10-08)</h4>
<div class="indent">Per a vote of the Jabber Council, changed status to Active. (psa)
    </div>
<h4>Version 0.3 (2003-06-22)</h4>
<div class="indent">Made several small editorial changes; added XML schemas. (psa)
    </div>
<h4>Version 0.2 (2003-01-08)</h4>
<div class="indent">Added information about non-HTTP URIs. (psa)
    </div>
<h4>Version 0.1 (2002-12-16)</h4>
<div class="indent">Initial version. (psa)
    </div>
</div>
<p><hr></p>
<p>END</p>
</body>
</html>
