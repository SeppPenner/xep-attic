<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>JEP-0030: Service Discovery</title>
<link rel="stylesheet" type="text/css" href="jep.css">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico">
<meta name="DC.Title" content="Service Discovery">
<meta name="DC.Creator" content="Joe Hildebrand">
<meta name="DC.Creator" content="Peter Millard">
<meta name="DC.Creator" content="Ryan Eatmon">
<meta name="DC.Creator" content="Peter Saint-Andre">
<meta name="DC.Description" content="This JEP defines a protocol for discovering (1) information about Jabber entities and (2) the items associated with such entities.">
<meta name="DC.Publisher" content="Jabber Software Foundation">
<meta name="DC.Contributor" content="JEP Editor">
<meta name="DC.Date" content="2005-03-03">
<meta name="DC.Type" content="Jabber Enhancement Proposal">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="JEP-0030">
<meta name="DC.Language" content="en">
<meta name="DC.Rights" content="This Jabber Enhancement Proposal is copyright 1999 - 2005 by the Jabber Software Foundation (JSF) and is in full conformance with the JSF's Intellectual Property Rights Policy &lt;http://www.jabber.org/jsf/ipr-policy.shtml&gt;. This material may be distributed only subject to the terms and conditions set forth in the Creative Commons Attribution License (&lt;http://creativecommons.org/licenses/by/2.5/&gt;).">
</head>
<body>
<h1>JEP-0030: Service Discovery</h1>
<p>This JEP defines a protocol for discovering (1) information about Jabber entities and (2) the items associated with such entities.</p>
<p><hr></p>
<p style="color:green">NOTICE: The protocol defined herein is a Final Standard of the Jabber Software Foundation and may be considered a stable technology for implementation and deployment.</p>
<p><hr></p>
<h2>JEP Information</h2>
<p class="indent">
            Status: Final<br>
            Type: Standards Track<br>
            Number: 0030<br>
            Version: 2.1<br>
            Last Updated: 2005-03-03<br>
            JIG: Standards JIG<br>
                Approving Body: Jabber Council<br>Dependencies: XMPP Core<br>Supersedes: JEP-0011, JEP-0094<br>
                Superseded By: None<br>
            Short Name: disco<br>
        Schema for disco#info: &lt;<a href="http://jabber.org/protocol/disco/info.xsd">http://jabber.org/protocol/disco/info.xsd</a>&gt;<br>
        Schema for disco#items: &lt;<a href="http://jabber.org/protocol/disco/items.xsd">http://jabber.org/protocol/disco/items.xsd</a>&gt;<br>
              Registry: 
              
              &lt;<a href="http://www.jabber.org/registrar/disco.html">http://www.jabber.org/registrar/disco.html</a>&gt;
              <br>
            Wiki Page: &lt;<a href="http://wiki.jabber.org/index.php/Service%20Discovery%20(JEP-0030)">http://wiki.jabber.org/index.php/Service Discovery (JEP-0030)</a>&gt;
          </p>
<h2>Author Information</h2>
<div class="indent">
<h3>Joe Hildebrand</h3>
<p class="indent">
        Email: jhildebrand@jabber.com<br>
        JID: hildjj@jabber.org</p>
<h3>Peter Millard</h3>
<p class="indent">
        Email: pgmillard@jabber.org<br>
        JID: pgmillard@jabber.org</p>
<h3>Ryan Eatmon</h3>
<p class="indent">
        Email: reatmon@jabber.org<br>
        JID: reatmon@jabber.org</p>
<h3>Peter Saint-Andre</h3>
<p class="indent">
        Email: stpeter@jabber.org<br>
        JID: stpeter@jabber.org</p>
</div>
<h2>Legal Notice</h2>
<p class="indent">This Jabber Enhancement Proposal is copyright 1999 - 2005 by the <a href="http://www.jabber.org/jsf/">Jabber Software Foundation</a> (JSF) and is in full conformance with the JSF's Intellectual Property Rights Policy &lt;<a href="http://www.jabber.org/jsf/ipr-policy.shtml">http://www.jabber.org/jsf/ipr-policy.shtml</a>&gt;. This material may be distributed only subject to the terms and conditions set forth in the Creative Commons Attribution License (&lt;<a href="http://creativecommons.org/licenses/by/2.5/">http://creativecommons.org/licenses/by/2.5/</a>&gt;).</p>
<h2>Discussion Venue</h2>
<p class="indent">The preferred venue for discussion of this document is the Standards-JIG discussion list: &lt;<a href="http://mail.jabber.org/mailman/listinfo/standards-jig">http://mail.jabber.org/mailman/listinfo/standards-jig</a>&gt;.</p>
<h2>Relation to XMPP</h2>
<p class="indent">The Extensible Messaging and Presence Protocol (XMPP) is defined in the XMPP Core (RFC 3920) and XMPP IM (RFC 3921) specifications contributed by the Jabber Software Foundation to the Internet Standards Process, which is managed by the Internet Engineering Task Force in accordance with RFC 2026. Any protocol defined in this JEP has been developed outside the Internet Standards Process and is to be understood as an extension to XMPP rather than as an evolution, development, or modification of XMPP itself.</p>
<h2>Conformance Terms</h2>
<p class="indent">The keywords "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in RFC 2119.</p>
<p><hr></p>
<h2>Table of Contents</h2>
<div class="indent"><dl>
<dt>1.  <a href="#intro">Introduction</a>
</dt>
<dt>2.  <a href="#reqs">Requirements</a>
</dt>
<dt>3.  <a href="#info">Discovering Information About a Jabber Entity</a>
</dt>
<dt>4.  <a href="#items">Discovering the Items Associated with a Jabber Entity</a>
</dt>
<dl>
<dt>4.1.  <a href="#items-basic">Basic Protocol</a>
</dt>
<dt>4.2.  <a href="#items-nodes">Nodes</a>
</dt>
<dt>4.3.  <a href="#items-hierarchy">Node Hierarchies</a>
</dt>
<dt>4.4.  <a href="#items-relationship">Relationship Between an Entity and its Items</a>
</dt>
</dl>
<dt>5.  <a href="#publish">Publishing Available Items</a>
</dt>
<dt>6.  <a href="#impl">Implementation Notes</a>
</dt>
<dt>7.  <a href="#errors">Error Conditions</a>
</dt>
<dt>8.  <a href="#security">Security Considerations</a>
</dt>
<dt>9.  <a href="#iana">IANA Considerations</a>
</dt>
<dt>10.  <a href="#registrar">Jabber Registrar Considerations</a>
</dt>
<dl>
<dt>10.1.  <a href="#registrar-protocol">Protocol Namespaces</a>
</dt>
<dt>10.2.  <a href="#registrar-reg">Registries</a>
</dt>
<dl>
<dt>10.2.1.  <a href="#registrar-reg-identity">Identity Categories and Types Registry</a>
</dt>
<dl>
<dt>10.2.1.1.  <a href="#registrar-identity">Process</a>
</dt>
<dt>10.2.1.2.  <a href="#registrar-reg-identity-init">Initial Submission</a>
</dt>
</dl>
<dt>10.2.2.  <a href="#registrar-reg-features">Features Registry</a>
</dt>
<dl>
<dt>10.2.2.1.  <a href="#registrar-reg-features-process">Process</a>
</dt>
<dt>10.2.2.2.  <a href="#registrar-reg-features-init">Initial Submission</a>
</dt>
</dl>
<dt>10.2.3.  <a href="#registrar-reg-nodes">Well-Known Nodes</a>
</dt>
<dl><dt>10.2.3.1.  <a href="#registrar-reg-nodes-process">Process</a>
</dt></dl>
</dl>
</dl>
<dt>11.  <a href="#schemas">XML Schemas</a>
</dt>
<dl>
<dt>11.1.  <a href="#schemas-info">disco#info</a>
</dt>
<dt>11.2.  <a href="#schemas-items">disco#items</a>
</dt>
</dl>
<dt><a href="#notes">Notes</a></dt>
<dt><a href="#revs">Revision History</a></dt>
</dl></div>
<p><hr></p>
<h2>1.
       <a name="intro">Introduction</a>
</h2>
    <p class="" style="">The ability to discover information about entities on the Jabber network is extremely valuable. Such information might include features offered or protocols supported by the entity, the entity's type or identity, and additional entities that are associated with the original entity in some way (often thought of as "children" of the "parent" entity). While mechanisms for doing so are not defined in <span class="ref" style="">XMPP Core</span>  [<a href="#nt-id2250282">1</a>], several protocols have been used in the past within the Jabber community for service discovery, specifically <span class="ref" style="">Jabber Browsing</span>  [<a href="#nt-id2250310">2</a>] and <span class="ref" style="">Agent Information</span>  [<a href="#nt-id2250333">3</a>]. However, those protocols are perceived to be inadequate for several reasons:</p>
    <ol start="" type="">
      <li><p class="" style="">Neither Jabber Browsing nor Agent Information is easily extensible. For example, the categories and subcategories listed for JID-Types in JEP-0011 are explicitly defined as the only official categories, and any additions to the list of JID-Types would require a modification to JEP-0011. While the Jabber Browsing specification does allow for the use of unofficial categories and types prefixed with the string 'x-', this introduces migration issues. This lack of flexibility violates one of the Jabber community's core <span class="ref" style="">Protocol Design Guidelines</span>  [<a href="#nt-id2250375">4</a>].</p></li>
      <li><p class="" style="">In Agent Information, there is no way to advertise supported features. While Jabber Browsing includes such a mechanism, the only way to express the availability of a feature is to advertise a supported protocol namespace. Yet some features may not be uniquely associated with a protocol namespace, which are one implementation of features but not the only one.</p></li>
      <li><p class="" style="">A Jabber Browsing result returns a combination of (1) namespaces supported by a Jabber Entity, (2) items associated with a Jabber Entity, and (3) namespaces supported by the associated items. This approach mixes information levels and requires parents to know everything about child nodes, thereby introducing significant confusion.</p></li>
      <li><p class="" style="">In both Jabber Browsing and Agent Information, items must be addressable as JIDs; however, this may not be possible in some applications.</p></li>
    </ol>
    <p class="" style="">This JEP addresses the perceived weaknesses of both the Jabber Browsing and Agent Information protocols. The result is a standards-track protocol for service discovery (often abbreviated to "disco", as is familiar in protocols such as <span class="ref" style="">Simple Object Access Protocol (SOAP)</span>  [<a href="#nt-id2256660">5</a>]).</p>
  <h2>2.
       <a name="reqs">Requirements</a>
</h2>
    <p class="" style="">The authors have designed the service discovery protocol with the following requirements in mind:</p>
    <ul>
      <li><p class="" style="">The protocol MUST support all functionality supported by the protocols it supersedes (Jabber Browsing and Agent Information).</p></li>
      <li>
        <p class="" style="">There are three kinds of information that need to be discovered about an entity:</p>
        <ol start="" type="">
          <li>its basic identity (type and/or category)</li>
          <li>the features it offers and protocols it supports</li>
          <li>any additional items associated with the entity, whether or not they are addressable as JIDs</li>
        </ol>
        <p class="" style="">All three MUST be supported, but the first two kinds of information relate to the entity itself whereas the third kind of information relates to items associated with the entity itself; therefore two different query types are needed.</p>
      </li>
      <li><p class="" style="">Discovering information about a child item MUST be accomplished by sending a separate discovery request to that item, not to the parent entity. (One result of this is that discovering complete information about an entire tree will require multiple request/response pairs in order to "walk the tree".)</p></li>
      <li><p class="" style="">The lists of identities and features MUST be flexible.</p></li>
      <li><p class="" style="">The protocol itself MUST be extensible.</p></li>
    </ul>
  <h2>3.
       <a name="info">Discovering Information About a Jabber Entity</a>
</h2>
    <p class="" style="">A requesting entity may want to discover information about another entity on the network. The information desired generally is of two kinds:</p>
    <ol start="" type="">
      <li>
<p class="" style=""><span style="font-weight: bold">The target entity's identity.</span> In disco, an entity's identity is broken down into its category (server, client, gateway, directory, etc.) and its particular type within that category (IM server, phone vs. handheld client, MSN gateway vs. AIM gateway, user directory vs. chatroom directory, etc.). This information helps requesting entities to determine the group or "bucket" of services into which the entity is most appropriately placed (e.g., perhaps the entity is shown in a GUI with an appropriate icon). An entity MAY have multiple identities. When multiple identity elements are provided, the name attributes for each identity element SHOULD have the same value.</p>
      </li>
      <li><p class="" style=""><span style="font-weight: bold">The features offered and protocols supported by the target entity.</span> This information helps requesting entities determine what actions are possible with regard to this entity (registration, search, join, etc.), what protocols the entity supports, and specific feature types of interest, if any (e.g., for the purpose of feature negotiation).</p></li>
    </ol>
    <p class="" style="">In order to discover such information, the requesting entity MUST send an IQ stanza of type "get", containing an empty &lt;query/&gt; element qualified by the 'http://jabber.org/protocol/disco#info' namespace, to the JID of the target entity (the 'to' address is REQUIRED and MUST contain a valid JID; a 'node' attribute on the &lt;query/&gt; element is OPTIONAL as described in the <a href="#items-nodes">Nodes</a> section of this document):</p>
    <p class="caption">Example 1. Querying for further information</p>
<div class="indent"><pre>
&lt;iq type='get'
    from='romeo@montague.net/orchard'
    to='plays.shakespeare.lit'
    id='info1'&gt;
  &lt;query xmlns='http://jabber.org/protocol/disco#info'/&gt;
&lt;/iq&gt;
    </pre></div>
    <p class="" style="">The target entity then MUST either return an IQ result, or return an error (see the <a href="#errors">Error Conditions</a> section of this document). The result MUST contain a &lt;query/&gt; element qualified by the 'http://jabber.org/protocol/disco#info' namespace, which in turn contains one or more &lt;identity/&gt; elements and one or more &lt;feature/&gt; elements. (Note: Every entity MUST have at least one identity, and every entity MUST support at least the 'http://jabber.org/protocol/disco#info' feature; however, an entity is not required to return a result and MAY return an error, most likely &lt;feature-not-implemented/&gt; or &lt;service-unavailable/&gt;, although other error conditions may be appropriate.) Each &lt;identity/&gt; element MUST possess 'category' and 'type' attributes specifying the category and type for the entity, and MAY possess a 'name' attribute specifying a natural-language name for the entity. Each &lt;feature/&gt; element MUST possess a 'var' attribute whose value is a protocol namespace or other feature offered by the entity. Preferably, both the category/type values and the feature values will be registered in a public registry, as described in the <a href="#registrar">Jabber Registrar Considerations</a> section of this document.</p>
    <p class="caption">Example 2. Result-set for information request</p>
<div class="indent"><pre>
&lt;iq type='result'
    from='plays.shakespeare.lit'
    to='romeo@montague.net/orchard'
    id='info1'&gt;
  &lt;query xmlns='http://jabber.org/protocol/disco#info'&gt;
    &lt;identity
        category='conference'
        type='text'
        name='Play-Specific Chatrooms'/&gt;
    &lt;identity
        category='directory'
        type='chatroom'
        name='Play-Specific Chatrooms'/&gt;
    &lt;feature var='http://jabber.org/protocol/disco#info'/&gt;
    &lt;feature var='http://jabber.org/protocol/disco#items'/&gt;
    &lt;feature var='http://jabber.org/protocol/muc'/&gt;
    &lt;feature var='jabber:iq:register'/&gt;
    &lt;feature var='jabber:iq:search'/&gt;
    &lt;feature var='jabber:iq:time'/&gt;
    &lt;feature var='jabber:iq:version'/&gt;
  &lt;/query&gt;
&lt;/iq&gt;
    </pre></div>
    <p class="" style="">If the JID or JID+Node of the specified target entity does not exist, the server or other authoritative entity SHOULD return an &lt;item-not-found/&gt; error, unless doing so would violate the privacy and security considerations specified in <span style="font-weight: bold">XMPP Core</span> and <span class="ref" style="">XMPP IM</span>  [<a href="#nt-id2257041">6</a>], or local privacy and security policies:</p>
    <p class="caption">Example 3. Target entity does not exist</p>
<div class="indent"><pre>
&lt;iq type='error'
    from='plays.shakespeare.lit'
    to='romeo@montague.net/orchard'
    id='info1'&gt;
  &lt;query xmlns='http://jabber.org/protocol/disco#info'/&gt;
  &lt;error code='404' type='cancel'&gt;
    &lt;item-not-found xmlns='urn:ietf:xml:params:ns:xmpp-stanzas'/&gt;
  &lt;/error&gt;
&lt;/iq&gt;
    </pre></div>
    <p class="" style="">If privacy and security considerations or policies prevent the server or other authoritative entity from returning an &lt;item-not-found/&gt; error, it SHOULD return a &lt;service-unavailable/&gt; error instead:</p>
    <p class="caption">Example 4. Service unavailable</p>
<div class="indent"><pre>
&lt;iq type='error'
    from='plays.shakespeare.lit'
    to='romeo@montague.net/orchard'
    id='info1'&gt;
  &lt;query xmlns='http://jabber.org/protocol/disco#info'/&gt;
  &lt;error code='503' type='cancel'&gt;
    &lt;service-unavailable xmlns='urn:ietf:xml:params:ns:xmpp-stanzas'/&gt;
  &lt;/error&gt;
&lt;/iq&gt;
    </pre></div>
    <p class="" style="">A query sent to a more specific entity may result in different or more detailed information. One example is sending a query to a particular conference room rather than the parent conference service:</p>
    <p class="caption">Example 5. Querying a specific conference room</p>
<div class="indent"><pre>
&lt;iq type='get'
    from='juliet@capulet.com/balcony'
    to='balconyscene@plays.shakespeare.lit'
    id='info2'&gt;
  &lt;query xmlns='http://jabber.org/protocol/disco#info'/&gt;
&lt;/iq&gt;

&lt;iq type='result'
    from='balconyscene@plays.shakespeare.lit'
    to='juliet@capulet.com/balcony'
    id='info2'&gt;
  &lt;query xmlns='http://jabber.org/protocol/disco#info'&gt;
    &lt;identity
        category='conference'
        type='text'
        name='Romeo and Juliet, Act II, Scene II'/&gt;
    &lt;feature var='http://jabber.org/protocol/disco#info'/&gt;
    &lt;feature var='http://jabber.org/protocol/muc'/&gt;
    &lt;feature var='http://jabber.org/protocol/feature-neg'/&gt;
    &lt;feature var='muc-password'/&gt;
    &lt;feature var='muc-hidden'/&gt;
    &lt;feature var='muc-temporary'/&gt;
    &lt;feature var='muc-open'/&gt;
    &lt;feature var='muc-unmoderated'/&gt;
    &lt;feature var='muc-nonanonymous'/&gt;
  &lt;/query&gt;
&lt;/iq&gt;</pre></div>
    <p class="" style="">Another example of this is sending a query to a specific connected resource for an IM user:</p>
    <p class="caption">Example 6. Querying a connected resource for further information</p>
<div class="indent"><pre>
&lt;iq type='get'
    from='juliet@capulet.com/balcony'
    to='romeo@montague.net/orchard'
    id='info3'&gt;
  &lt;query xmlns='http://jabber.org/protocol/disco#info'/&gt;
&lt;/iq&gt;

&lt;iq type='result'
    from='romeo@montague.net/orchard'
    to='juliet@capulet.com/balcony'
    id='info3'&gt;
  &lt;query xmlns='http://jabber.org/protocol/disco#info'&gt;
    &lt;identity
        category='client'
        type='pc'
        name='Gabber'/&gt;
    &lt;feature var='jabber:iq:time'/&gt;
    &lt;feature var='jabber:iq:version'/&gt;
  &lt;/query&gt;
&lt;/iq&gt;
    </pre></div>
    <p class="" style="">A query MAY also be directed to a specific node identifier associated with a JID:</p>
    <p class="caption">Example 7. Querying a specific JID and node combination</p>
<div class="indent"><pre>
&lt;iq type='get'
    from='romeo@montague.net/orchard'
    to='mim.shakespeare.lit'
    id='info3'&gt;
  &lt;query xmlns='http://jabber.org/protocol/disco#info' 
         node='http://jabber.org/protocol/commands'/&gt;
&lt;/iq&gt;
    </pre></div>
    <p class="caption">Example 8. JID+node result</p>
<div class="indent"><pre>
&lt;iq type='result'
    from='mim.shakespeare.lit'
    to='romeo@montague.net/orchard'
    id='info3'&gt;
  &lt;query xmlns='http://jabber.org/protocol/disco#info' 
         node='http://jabber.org/protocol/commands'&gt;
    &lt;identity
        category='automation'
        type='command-list'/&gt;
  &lt;/query&gt;
&lt;/iq&gt;
    </pre></div>
    <p class="" style="">If a specific entity (JID or JID+node) does not support the disco#info namespace, does not have a defined identity, or refuses to return disco#info results to the specific requesting entity or to any requesting entity, it SHOULD return an appropriate error message (such as &lt;service-unavailable/&gt;, &lt;feature-not-implemented/&gt;, &lt;forbidden/&gt;, or &lt;not-allowed/&gt;, respectively). One example is shown below.</p>
    <p class="caption">Example 9. JID+node error</p>
<div class="indent"><pre>
&lt;iq type='error'
    from='mim.shakespeare.lit'
    to='romeo@montague.net/orchard'
    id='info3'&gt;
  &lt;query xmlns='http://jabber.org/protocol/disco#info' 
         node='http://jabber.org/protocol/commands'/&gt;
  &lt;error code='405' type='cancel'&gt;
    &lt;not-allowed xmlns='urn:ietf:params:xml:ns:xmpp-stanzas'/&gt;
  &lt;/error&gt;
&lt;/iq&gt;
    </pre></div>
    <p class="" style="">Other error conditions may be appropriate depending on the application; refer to the <a href="#errors">Error Conditions</a> section of this document.</p>
  <h2>4.
       <a name="items">Discovering the Items Associated with a Jabber Entity</a>
</h2>
    <div class="indent">
<h3>4.1 <a name="items-basic">Basic Protocol</a>
</h3>
      <p class="" style="">In order for the requesting entity to discover the items associated with a Jabber Entity, it MUST send an IQ stanza of type "get" to the target entity, containing an empty &lt;query/&gt; element qualified by the 'http://jabber.org/protocol/disco#items' namespace:</p>
      <p class="caption">Example 10. Requesting all items</p>
<div class="indent"><pre>
&lt;iq type='get'
    from='romeo@montague.net/orchard'
    to='shakespeare.lit'
    id='items1'&gt;
  &lt;query xmlns='http://jabber.org/protocol/disco#items'/&gt;
&lt;/iq&gt;
      </pre></div>
      <p class="" style="">The target entity then MUST either return its list of publicly-available items, or return an error. The list of items MUST be provided in an IQ stanza of type "result", with each item specified by means of an &lt;item/&gt; child of a &lt;query/&gt; element qualified by the 'http://jabber.org/protocol/disco#items' namespace (the &lt;item/&gt; child MUST possess a 'jid' attribute specifying the JID of the item and MAY possess a 'name' attribute specifying a natural-language name for the item):</p>
      <p class="caption">Example 11. Result-set for all items</p>
<div class="indent"><pre>
&lt;iq type='result'
    from='shakespeare.lit'
    to='romeo@montague.net/orchard'
    id='items1'&gt;
  &lt;query xmlns='http://jabber.org/protocol/disco#items'&gt;
    &lt;item jid='people.shakespeare.lit'
          name='Directory of Characters'/&gt;
    &lt;item jid='plays.shakespeare.lit'
          name='Play-Specific Chatrooms'/&gt;
    &lt;item jid='mim.shakespeare.lit'
          name='Gateway to Marlowe IM'/&gt;
    &lt;item jid='words.shakespeare.lit'
          name='Shakespearean Lexicon'/&gt;
    &lt;item jid='globe.shakespeare.lit'
          name='Calendar of Performances'/&gt;
    &lt;item jid='headlines.shakespeare.lit'
          name='Latest Shakespearean News'/&gt;
    &lt;item jid='catalog.shakespeare.lit'
          name='Buy Shakespeare Stuff!'/&gt;
    &lt;item jid='en2fr.shakespeare.lit'
          name='French Translation Service'/&gt;
  &lt;/query&gt;
&lt;/iq&gt;
      </pre></div>
      <p class="" style="">The &lt;item/&gt; element MUST NOT contain XML character data and SHOULD be empty; while it MAY contain XML data in another namespace, such data MUST be ignored if an implementation does not understand it.</p>
      <p class="" style="">If there are no items associated with an entity (or if those items are not publicly available), the target entity MUST return an empty query element to the requesting entity:</p>
      <p class="caption">Example 12. Empty result set</p>
<div class="indent"><pre>
&lt;iq type='result'
    from='shakespeare.lit'
    to='romeo@montague.net/orchard'
    id='items1'&gt;
  &lt;query xmlns='http://jabber.org/protocol/disco#items'/&gt;
&lt;/iq&gt;
      </pre></div>
    </div>
    <div class="indent">
<h3>4.2 <a name="items-nodes">Nodes</a>
</h3>
      <p class="" style="">It is possible that an item associated with an entity will not be addressable as a JID; examples might include offline messages stored in an inbox (see <span class="ref" style="">Flexible Offline Message Retrieval</span>  [<a href="#nt-id2257296">7</a>]), entries in a Jabber-enabled weblog, XML-RPC services associated with a client or component, items available in an online trading system (e.g., a catalog or auction), news postings located at an NNTP gateway, and topics hosted by a <span class="ref" style="">Publish-Subscribe</span>  [<a href="#nt-id2257327">8</a>] component. In order to handle such items, the &lt;item/&gt; element MAY possess an OPTIONAL 'node' attribute that supplements the REQUIRED 'jid' attribute.</p>
      <p class="" style="">The value of the node attribute may or may not have semantic meaning; from the perspective of Service Discovery, a node is merely something that is associated with an entity. In order to discover more about the node, the requesting entity MUST query the entity's JID while specifying the node. If the value of the 'node' attribute has semantic meaning, that meaning is provided by the using protocol or application, not by the Service Discovery protocol. A node attribute SHOULD NOT be included unless it is necessary to provide or discover information about an entity that cannot be directly addressed as a JID (i.e., if the associated item can be addressed as a JID, do not include a node). The value of the 'node' attribute MUST NOT be null.</p>
      <p class="" style="">In the following example, a user requests all available items from an online catalog service:</p>
      <p class="caption">Example 13. Requesting nodes</p>
<div class="indent"><pre>
&lt;iq type='get'
    from='romeo@montague.net/orchard'
    to='catalog.shakespeare.lit'
    id='items2'&gt;
  &lt;query xmlns='http://jabber.org/protocol/disco#items'/&gt;
&lt;/iq&gt;
        </pre></div>
        <p class="" style="">If there are items associated with the target entity but they are not addressable as JIDs, the service SHOULD then return a list of nodes (where each &lt;item/&gt; element MUST possess a 'jid' attribute, SHOULD possess a 'node' attribute, and MAY possess a 'name' attribute):</p>
        <p class="caption">Example 14. Service returns nodes</p>
<div class="indent"><pre>
&lt;iq type='result'
    from='catalog.shakespeare.lit'
    to='romeo@montague.net/orchard'
    id='items2'&gt;
  &lt;query xmlns='http://jabber.org/protocol/disco#items'&gt;
    &lt;item jid='catalog.shakespeare.lit'
          node='books'
          name='Books by and about Shakespeare'/&gt;
    &lt;item jid='catalog.shakespeare.lit'
          node='clothing'
          name='Wear your literary taste with pride'/&gt;
    &lt;item jid='catalog.shakespeare.lit'
          node='music'
          name='Music from the time of Shakespeare'/&gt;
  &lt;/query&gt;
&lt;/iq&gt;
      </pre></div>
      <p class="" style="">There may be futher nodes associated with the "first-level" nodes returned in the above query (e.g., the nodes may be categories that have associated items). The requesting entity can query a node further by sending a request to the JID and specifying the node of interest in the query.</p>
      <p class="caption">Example 15. Requesting further nodes</p>
<div class="indent"><pre>
&lt;iq type='get'
    from='romeo@montague.net/orchard'
    to='catalog.shakespeare.lit'
    id='items3'&gt;
  &lt;query xmlns='http://jabber.org/protocol/disco#items' 
         node='music'/&gt;
&lt;/iq&gt;
      </pre></div>
      <p class="" style="">The service then returns the further nodes associated with the "parent" node. In the following example, the service itself enforces an alphabetically-ordered hierarchical structure on the nodes that are returned, but such a structure is a matter of implementation rather than protocol.</p>
      <p class="caption">Example 16. Service returns further nodes</p>
<div class="indent"><pre>
&lt;iq type='result'
    from='catalog.shakespeare.lit'
    to='romeo@montague.net/orchard'
    id='items3'&gt;
  &lt;query xmlns='http://jabber.org/protocol/disco#items' 
         node='music'&gt;
    &lt;item jid='catalog.shakespeare.lit'
          node='music/A'/&gt;
    &lt;item jid='catalog.shakespeare.lit'
          node='music/B'/&gt;
    &lt;item jid='catalog.shakespeare.lit'
          node='music/C'/&gt;
    &lt;item jid='catalog.shakespeare.lit'
          node='music/D'/&gt;
    .
    .
    .
  &lt;/query&gt;
&lt;/iq&gt;
      </pre></div>
      <p class="" style="">The requesting entity can then query further if desired:</p>
      <p class="caption">Example 17. Requesting even more nodes</p>
<div class="indent"><pre>
&lt;iq type='get'
    from='romeo@montague.net/orchard'
    to='catalog.shakespeare.lit'
    id='items4'&gt;
  &lt;query xmlns='http://jabber.org/protocol/disco#items' 
         node='music/D'/&gt;
&lt;/iq&gt;
      </pre></div>
      <p class="caption">Example 18. Service returns even more nodes</p>
<div class="indent"><pre>
&lt;iq type='result'
    from='catalog.shakespeare.lit'
    to='romeo@montague.net/orchard'
    id='items4'&gt;
  &lt;query xmlns='http://jabber.org/protocol/disco#items' 
         node='music/D'&gt;
    &lt;item jid='catalog.shakespeare.lit'
          node='music/D/dowland-firstbooke'
          name='John Dowland - First Booke of Songes or Ayres'/&gt;
    &lt;item jid='catalog.shakespeare.lit'
          node='music/D/dowland-solace'
          name='John Dowland - A Pilgrimes Solace'/&gt;
  &lt;/query&gt;
&lt;/iq&gt;
      </pre></div>
    </div>
    <div class="indent">
<h3>4.3 <a name="items-hierarchy">Node Hierarchies</a>
</h3>
      <p class="" style="">The foregoing examples show a hierarchy of nodes, in which some nodes are branches (i.e., contain further nodes) and some nodes are leaves (i.e., do not contain further nodes). The "hierarchy" category SHOULD be used to identify such nodes, where the "branch" and "leaf" types are exhaustive of the types within this category.</p>
      <p class="" style="">If the hierarchy category is used, every node in the hierarchy MUST be identified as either a branch or a leaf; however, since a node MAY have multiple identities, any given node MAY also possess an identity other than "hierarchy/branch" or "hierarchy/leaf".</p>
      <p class="" style="">Therefore, a disco#info request to the "music/D" node shown above would yield &lt;identity category='hierarchy' type='branch'/&gt; while a disco#info request to the "music/D/dowland-firstbooke" node would yield &lt;identity category='hierarchy' type='leaf'/&gt; (and each node could yield additional identities as appropriate).</p>
    </div>
    <div class="indent">
<h3>4.4 <a name="items-relationship">Relationship Between an Entity and its Items</a>
</h3>
      <p class="" style="">This section explains in greater detail the relationship between an entity and its associated items.</p>
      <p class="" style="">In general, the items returned by an entity in a disco#items result MUST be items over which the entity has some relationship of ownership -- either direct control over the item itself (e.g., <span style="font-weight: bold">Publish-Subscribe</span> nodes owned by the entity) or at least the ability to provide or vouch for the item in a canonical way on the Jabber network (e.g., groupchat rooms directly hosted by a multi-user chat service or IRC channels to which a gateway provides access).</p>
      <p class="" style="">Such a relationship does not constrain the relationship between the owning entity's address and the address of the associated entity. In particular, any of the following scenarios is perfectly acceptable:</p>
      <ol start="" type="">
        <li><p class="" style="">Upon querying an entity (JID1) for items, one receives a list of items that can be addressed as JIDs; each associated item has its own JID, but no such JID equals JID1.</p></li>
        <li><p class="" style="">Upon querying an entity (JID1) for items, one receives a list of items that cannot be addressed as JIDs; each associated item has its own JID+node, where each JID equals JID1 and each NodeID is unique.</p></li>
        <li><p class="" style="">Upon querying an entity (JID1+NodeID1) for items, one receives a list of items that can be addressed as JIDs; each associated item has its own JID, but no such JID equals JID1.</p></li>
        <li><p class="" style="">Upon querying an entity (JID1+NodeID1) for items, one receives a list of items that cannot be addressed as JIDs; each associated item has its own JID+node, but no such JID+node equals JID1+NodeID1 and each NodeID is unique in the context of the associated JID.</p></li>
      </ol>
      <p class="" style="">In addition, the results MAY also be mixed, so that a query to a JID or a JID+node could yield both (1) items that are addressed as JIDs and (2) items that are addressed as JID+node combinations.</p>
      <p class="" style="">Consider the case of an entity that owns multiple publish-subscribe nodes -- for example, a person who owns one such node for each of his music players. The following examples show what the disco#items query and result might look like (using the protocol defined in <span class="ref" style="">User Tune</span>  [<a href="#nt-id2257682">9</a>]):</p>
      <p class="caption">Example 19. User queries entity regarding tunes</p>
<div class="indent"><pre>
&lt;iq from='juliet@capulet.com/chamber'
    id='items4'
    to='romeo@montague.net'
    type='get'&gt;
  &lt;query xmlns='http://jabber.org/protocol/disco#items' 
         node='http://jabber.org/protocol/tune'/&gt;
&lt;/iq&gt;
      </pre></div>
      <p class="" style="">The queried entity now returns a list of publish-subscribe nodes over which it has control, each of which is hosted on a different pubsub service:</p> 
      <p class="caption">Example 20. Entity returns multiple items</p>
<div class="indent"><pre>
&lt;iq from='romeo@montague.net'
    id='items4'
    to='juliet@capulet.com/chamber'
    type='get'&gt;
  &lt;query xmlns='http://jabber.org/protocol/disco#items' 
         node='http://jabber.org/protocol/tune'&gt;
    &lt;item jid='pubsub.shakespeare.lit'
          name='Romeo&amp;apos;s CD player'
          node='s623nms9s3bfh8js'/&gt;
    &lt;item jid='pubsub.montague.net'
          node='music/R/Romeo/iPod'/&gt;
    &lt;item jid='tunes.characters.lit'
          node='g8k4kds9sd89djf3'/&gt;
  &lt;/query&gt;
&lt;/iq&gt;
      </pre></div>
    </div>
  <h2>5.
       <a name="publish">Publishing Available Items</a>
</h2>
    <p class="" style="">The server handling rules defined in <span style="font-weight: bold">XMPP IM</span> require that the server itself reply on behalf of the user if the 'to' attribute of an IQ get or set is of the form &lt;user@host&gt;. This functionality is currently employed so that the user can "publish" information (e.g., vCard information as specified in <span class="ref" style="">vcard-temp</span>  [<a href="#nt-id2257772">10</a>]) in a way that makes it possible for other entities to retrieve that information even if the user is unavailable. The service discovery specification defined herein builds on that notion by enabling a user to publish some of its service discovery information to the server, which shall store that information in persistent storage and return that information when other entities request it from the user's "bare JID" (user@host), either alone or in combination with a particular node.</p>
    <p class="" style="">Implementations of service discovery that are built into instant messaging servers SHOULD allow user to publish items in this fashion, although they are not required to do so in order to conform to the service discovery specification. In order to discover whether his or her server supports this publish functionality, the user SHOULD send a disco#info request to his or her server:</p>
    <p class="caption">Example 21. User sends disco#info request to server</p>
<div class="indent"><pre>
&lt;iq from='kinglear@shakespeare.lit'
    id='pubinfo'
    to='shakespeare.lit'
    type='get'&gt;
  &lt;query xmlns='http://jabber.org/protocol/disco#info'/&gt;
&lt;/iq&gt;
    </pre></div>
    <p class="" style="">If the server supports service discovery publishing and the server wishes to disclose that fact to the user, it MUST include a feature of 'http://jabber.org/protocol/disco#publish' in its response.</p>
    <p class="caption">Example 22. Server responds with identity and feature information</p>
<div class="indent"><pre>
&lt;iq from='shakespeare.lit'
    id='pubinfo'
    to='kinglear@shakespeare.lit'
    type='result'&gt;
  &lt;query xmlns='http://jabber.org/protocol/disco#info'&gt;
    &lt;identity category='server' type='im'/&gt;
    ...
    &lt;feature var='http://jabber.org/protocol/disco#publish'/&gt;
    ...
  &lt;/query&gt;
&lt;/iq&gt;
    </pre></div>

    <p class="" style="">In order to publish items, an entity uses an IQ-set transaction to its server, which is responsible for responding to requests on behalf of that entity. Each &lt;item/&gt; child element of the parent query MUST possess the following attributes:</p>
    <ul>
      <li>
<span style="font-weight: bold">action</span> -- specifies the action to be taken for the item</li>
      <li>
<span style="font-weight: bold">jid</span> -- specifies the Jabber ID of the item "owner" or location</li>
    </ul>
    <p class="" style="">The &lt;item/&gt; element MAY also possess the following attributes:</p>
    <ul>
      <li>
<span style="font-weight: bold">name</span> -- specifies a natural-language name for the item.</li>
      <li>
<span style="font-weight: bold">node</span> -- specifies the particular node associated with the JID of the item "owner" or location</li>
    </ul>
    <p class="" style="">The allowable values for the 'action' attribute are "update" and "remove"). If the action is "update", the server MUST either create a new entry (if the node and jid combination does not already exist) or overwrite an existing entry. If the action is "remove", the item MUST be removed from persistent storage.</p>
    <p class="" style="">The following example shows a user publishing a list of his biological children to a well-known (but fictitious) service discovery node.</p>
    <p class="caption">Example 23. Publishing items</p>
<div class="indent"><pre>
&lt;iq from='kinglear@shakespeare.lit'
    id='publish1'
    type='set'&gt;
  &lt;query xmlns='http://jabber.org/protocol/disco#items'
         node='jabber:iq:kids'&gt;
    &lt;item action='update'
          jid='cordelia@shakespeare.lit'
          name='Cordelia'/&gt;
    &lt;item action='update'
          jid='goneril@shakespeare.lit'
          name='Goneril'/&gt;
    &lt;item action='update'
          jid='regan@shakespeare.lit'
          name='Regan'/&gt;
  &lt;/query&gt;
&lt;/iq&gt;
    </pre></div>

    <p class="caption">Example 24. Server responds with success</p>
<div class="indent"><pre>
&lt;iq id='publish1'
    to='kinglear@shakespeare.lit'
    type='result'/&gt;
    </pre></div>

    <p class="" style="">Subsequent queries to "jid='kinglear@shakespeare.lit'" and "node='jabber:iq:kids'" will yield the list shown above (absent the 'action' attributes).</p>

    <p class="" style="">If the server or service does not support persistent storage, it MUST respond to IQ-set requests with a &lt;feature-not-implemented/&gt; error.</p>

    <p class="caption">Example 25. Persistent storage is not available</p>
<div class="indent"><pre>
&lt;iq id='publish1'
    to='kinglear@shakespeare.lit'
    type='error'&gt;
  &lt;query xmlns='http://jabber.org/protocol/disco#items'
         node='jabber:iq:kids'&gt;
    &lt;item action='update'
          jid='cordelia@shakespeare.lit'
          name='Cordelia'/&gt;
    &lt;item action='update'
          jid='goneril@shakespeare.lit'
          name='Goneril'/&gt;
    &lt;item action='update'
          jid='regan@shakespeare.lit'
          name='Regan'/&gt;
  &lt;/query&gt;
  &lt;error code='501' type='cancel'&gt;
    &lt;feature-not-implemented xmlns='urn:ietf:xml:params:ns:xmpp-stanzas'/&gt;
  &lt;/error&gt;
&lt;/iq&gt;
    </pre></div>

  <h2>6.
       <a name="impl">Implementation Notes</a>
</h2>
    <p class="" style="">In order to retrieve full information about an entity and its associated items, the requesting application needs to "walk the tree" of items. Naturally, this can result in a large number of requests and responses. The requesting application SHOULD NOT send follow-up requests to all items associated with an entity if the list of such items is long (e.g., more than twenty items). Entities that will routinely host a large number of items (e.g., IRC gateways or NNTP services) SHOULD structure nodes into hierarchies and/or provide more robust searching capabilities, for example via <span class="ref" style="">Jabber Search</span>  [<a href="#nt-id2258004">11</a>]; they SHOULD NOT return extremely large result sets via Service Discovery.</p>
    <p class="" style="">This JEP does not require that a responding entity must return the same results in response to the same request from different requesting entities (e.g., an entity could return a different list of items or features based on the degree to which it trusts the requesting entity, or based on the known capabilities of the requesting entity). However, the responding entity SHOULD return the same &lt;identity/&gt; element (category+type) to all disco#info requests sent to the same JID+node combination.</p>
    <p class="" style="">As mentioned above, when an entity sends a request to a bare JID (account@domain) hosted by a server, the server itself shall reply on behalf of the hosted account. The primary identity returned in the server's response to a disco#info query SHOULD have a category of "account", with an appropriate type as specified in the Service Discovery Identities registry (most likely, a type of "registered"). In response to a disco#items query, if the requesting entity is subscribed to the account's presence, then the server SHOULD include one &lt;item/&gt; for each of the account's "available resources" (as that term is defined in <span style="font-weight: bold">RFC 3921</span>); if the requesting entity is not subscribed to the account's presence, then the server MUST NOT return items for the account's available resources.</p>
  <h2>7.
       <a name="errors">Error Conditions</a>
</h2>
    <p class="" style="">The following table summarizes the common error conditions that can have special meaning in the context of Service Discovery (for information regarding error condition syntax and semantics, see <span class="ref" style="">Error Condition Mappings</span>  [<a href="#nt-id2258096">12</a>]).</p>
    <p class="caption">Table 1: Error Conditions</p>
<table border="1" cellpadding="3" cellspacing="0">
      <tr class="body">
        <th colspan="" rowspan="">Condition</th>
        <th colspan="" rowspan="">Cause</th>
      </tr>
      <tr class="body">
        <td align="" colspan="" rowspan="">&lt;feature-not-implemented/&gt;</td>
        <td align="" colspan="" rowspan="">The sender has attempted to publish items but the server does not support the <a href="#publish">Publishing Available Items</a> feature.</td>
      </tr>
      <tr class="body">
        <td align="" colspan="" rowspan="">&lt;item-not-found/&gt;</td>
        <td align="" colspan="" rowspan="">The JID or JID+NodeID of the specified target entity does not exist and that fact can be divulged in accordance with privacy and security considerations and policies.</td>
      </tr>
      <tr class="body">
        <td align="" colspan="" rowspan="">&lt;service-unavailable/&gt;</td>
        <td align="" colspan="" rowspan="">The target entity does not support this protocol, or the specified target entity does not exist but that fact cannot be divulged because of pricacy and security considerations.</td>
      </tr>
    </table>
    <p class="" style="">The other error conditions specified in <span style="font-weight: bold">XMPP Core</span> MAY be returned as well (&lt;forbidden/&gt;, &lt;not-allowed/&gt;, &lt;not-authorized/&gt;, etc.), including application-specific conditions.</p>
    <p class="" style="">As noted above, if an entity has no associated items, it MUST return an empty &lt;query/&gt; element (rather than an error) in response to a disco#items request.</p>
  <h2>8.
       <a name="security">Security Considerations</a>
</h2>
    <p class="" style="">Certain attacks may be made easier when an entity discloses (via disco#info responses) that it supports particular protocols or features; however, in general, service discovery introduces no new vulnerabilities, since a malicious entity could discover that the responding entity supports such protocols and features by sending requests specific to those protocols rather than by sending service discovery requests.</p>
    <p class="" style="">A responding entity is under no obligation to return the identical service discovery response when replying to service discovery requests received from different requesting entities, and MAY perform authorization checks before responding in order to determine how (or whether) to respond.</p>
  <h2>9.
       <a name="iana">IANA Considerations</a>
</h2>
    <p class="" style="">This JEP requires no interaction with the <span class="ref" style="">Internet Assigned Numbers Authority (IANA)</span>  [<a href="#nt-id2258296">13</a>].</p>
  <h2>10.
       <a name="registrar">Jabber Registrar Considerations</a>
</h2>
    <div class="indent">
<h3>10.1 <a name="registrar-protocol">Protocol Namespaces</a>
</h3>
      <p class="" style="">The <span class="ref" style="">Jabber Registrar</span>  [<a href="#nt-id2258380">14</a>] includes the 'http://jabber.org/protocol/disco#info' and 'http://jabber.org/protocol/disco#items' namespaces in its registry of protocol namespaces.</p>
    </div>
    <div class="indent">
<h3>10.2 <a name="registrar-reg">Registries</a>
</h3>
      <div class="indent">
<h3>10.2.1 <a name="registrar-reg-identity">Identity Categories and Types Registry</a>
</h3>
        <p class="" style="">The Jabber Registrar shall maintain a registry of values for the 'category' and 'type' attributes of the &lt;identity/&gt; element in the 'http://jabber.org/protocol/disco#info' namespace; see &lt;<a href="http://www.jabber.org/registrar/disco-categories.html">http://www.jabber.org/registrar/disco-categories.html</a>&gt;.</p>
        <div class="indent">
<h3>10.2.1.1 <a name="registrar-identity">Process</a>
</h3>
          <p class="" style="">In order to submit new values to this registry, the registrant must define an XML fragment of the following form and either include it in the relevant Jabber Enhancement Proposal or send it to the email address &lt;registrar@jabber.org&gt;:</p>
          <p class="caption"></p>
<div class="indent"><pre>
&lt;category&gt;
  &lt;name&gt;the name of the category (all lower-case)&lt;/name&gt;
  &lt;desc&gt;a natural-language description of the category&lt;/desc&gt;
  &lt;type&gt;
    &lt;name&gt;the name of the specific type (all lower-case)&lt;/name&gt;
    &lt;desc&gt;a natural-language description of the type&lt;/desc&gt;
    &lt;doc&gt;the document (e.g., JEP) in which this type is specified&lt;/doc&gt;
  &lt;/type&gt;
&lt;/category&gt;
          </pre></div>
          <p class="" style="">The registrant may register more than one category at a time, each contained in a separate &lt;category/&gt; element. The registrant may also register more than one type at a time, each contained in a separate &lt;type/&gt; child element. Registrations of new types within an existing category must include the full XML snippet but should not include the category description (only the name).</p>
        </div>
        <div class="indent">
<h3>10.2.1.2 <a name="registrar-reg-identity-init">Initial Submission</a>
</h3>
          <p class="" style="">This JEP defines a "hierarchy" category that contains two and only two types: "branch" and "leaf"; the associated registry submission is as follows:</p>
          <p class="caption"></p>
<div class="indent"><pre>
&lt;category&gt;
  &lt;name&gt;hierarchy&lt;/name&gt;
  &lt;desc&gt;
    An entity that exists in the context of a 
    service discovery node hierarchy.
  &lt;/desc&gt;
  &lt;type&gt;
    &lt;name&gt;branch&lt;/name&gt;
    &lt;desc&gt;
      A "container node" for other entities in a 
      service discovery node hierarchy.
    &lt;/desc&gt;
    &lt;doc&gt;JEP-0030&lt;/doc&gt;
  &lt;/type&gt;
  &lt;type&gt;
    &lt;name&gt;leaf&lt;/name&gt;
    &lt;desc&gt;
      A "terminal node" in a service discovery 
      node hierarchy.
    &lt;/desc&gt;
    &lt;doc&gt;JEP-0030&lt;/doc&gt;
  &lt;/type&gt;
&lt;/category&gt;
          </pre></div>
        </div>
      </div>
      <div class="indent">
<h3>10.2.2 <a name="registrar-reg-features">Features Registry</a>
</h3>
        <p class="" style="">The Jabber Registrar shall maintain a registry of features for use as values of the 'var' attribute of the &lt;feature/&gt; element in the 'http://jabber.org/protocol/disco#info' namespace; see &lt;<a href="http://www.jabber.org/registrar/disco-vars.html">http://www.jabber.org/registrar/disco-vars.html</a>&gt;.</p>
        <div class="indent">
<h3>10.2.2.1 <a name="registrar-reg-features-process">Process</a>
</h3>
          <p class="" style="">In order to submit new values to this registry, the registrant must define an XML fragment of the following form and either include it in the relevant Jabber Enhancement Proposal or send it to the email address &lt;registrar@jabber.org&gt;:</p>
          <p class="caption"></p>
<div class="indent"><pre>
&lt;feature var='name of feature or namespace'&gt;
  &lt;desc&gt;a natural-language description of the feature&lt;/desc&gt;
  &lt;doc&gt;the document (e.g., JEP) in which this feature is specified&lt;/doc&gt;
&lt;/feature&gt;</pre></div>
          <p class="" style="">The registrant may register more than one feature at a time, each contained in a separate &lt;feature/&gt; element.</p>
        </div>
        <div class="indent">
<h3>10.2.2.2 <a name="registrar-reg-features-init">Initial Submission</a>
</h3>
          <p class="" style="">This JEP defines a "publish" feature that is not associated with either of the protocol namespaces listed above; the registry submission for this feature is as follows:</p>
          <p class="caption"></p>
<div class="indent"><pre>
&lt;feature var='http://jabber.org/protocol/disco#publish'&gt;
  &lt;desc&gt;the service discovery "publish" feature&lt;/desc&gt;
  &lt;doc&gt;JEP-0030&lt;/doc&gt;
&lt;/feature&gt;
          </pre></div>
        </div>
      </div>
      <div class="indent">
<h3>10.2.3 <a name="registrar-reg-nodes">Well-Known Nodes</a>
</h3>
        <p class="" style="">A using protocol may specify one or more service discovery nodes that have a special and well-defined meaning in the context of that protocol. For the purpose of reserving these node names globally across all Jabber protocols, the Jabber Registrar shall maintain a registry of well-known service discovery nodes; see &lt;<a href="http://www.jabber.org/registrar/disco-nodes.html">http://www.jabber.org/registrar/disco-nodes.html</a>&gt;.</p>
        <div class="indent">
<h3>10.2.3.1 <a name="registrar-reg-nodes-process">Process</a>
</h3>
          <p class="" style="">In order to submit new values to this registry, the registrant must define an XML fragment of the following form and either include it in the relevant Jabber Enhancement Proposal or send it to the email address &lt;registrar@jabber.org&gt;:</p>
          <p class="caption"></p>
<div class="indent"><pre>
&lt;node&gt;
  &lt;name&gt;the name of the node&lt;/name&gt;
  &lt;desc&gt;a natural-language description of the node&lt;/desc&gt;
  &lt;doc&gt;the document (e.g., JEP) in which this node is specified&lt;/doc&gt;
&lt;/node&gt;
          </pre></div>
          <p class="" style="">The registrant may register more than one node at a time, each contained in a separate &lt;node/&gt; element.</p>
        </div>
      </div>
    </div>
  <h2>11.
       <a name="schemas">XML Schemas</a>
</h2>
    <div class="indent">
<h3>11.1 <a name="schemas-info">disco#info</a>
</h3>
      <p class="caption"></p>
<div class="indent"><pre>
&lt;?xml version='1.0' encoding='UTF-8' ?&gt;

&lt;xs:schema
    xmlns:xs='http://www.w3.org/2001/XMLSchema'
    targetNamespace='http://jabber.org/protocol/disco#info'
    xmlns='http://jabber.org/protocol/disco#info'
    elementFormDefault='qualified'&gt;

  &lt;xs:annotation&gt;
    &lt;xs:documentation&gt;
      The protocol documented by this schema is defined in
      JEP-0030: http://www.jabber.org/jeps/jep-0030.html
    &lt;/xs:documentation&gt;
  &lt;/xs:annotation&gt;

  &lt;xs:element name='query'&gt;
    &lt;xs:complexType&gt;
      &lt;xs:sequence minOccurs='0'&gt;
        &lt;xs:element ref='identity' maxOccurs='unbounded'/&gt;
        &lt;xs:element ref='feature' maxOccurs='unbounded'/&gt;
      &lt;/xs:sequence&gt;
      &lt;xs:attribute name='node' type='xs:string' use='optional'/&gt;
    &lt;/xs:complexType&gt;
  &lt;/xs:element&gt;

  &lt;xs:element name='identity'&gt;
    &lt;xs:complexType&gt;
      &lt;xs:simpleContent&gt;
        &lt;xs:extension base='empty'&gt;
          &lt;xs:attribute name='category' type='xs:string' use='required'/&gt;
          &lt;xs:attribute name='name' type='xs:string' use='optional'/&gt;
          &lt;xs:attribute name='type' type='xs:string' use='required'/&gt;
        &lt;/xs:extension&gt;
      &lt;/xs:simpleContent&gt;
    &lt;/xs:complexType&gt;
  &lt;/xs:element&gt;

  &lt;xs:element name='feature'&gt;
    &lt;xs:complexType&gt;
      &lt;xs:simpleContent&gt;
        &lt;xs:extension base='empty'&gt;
          &lt;xs:attribute name='var' type='xs:string' use='required'/&gt;
        &lt;/xs:extension&gt;
      &lt;/xs:simpleContent&gt;
    &lt;/xs:complexType&gt;
  &lt;/xs:element&gt;

  &lt;xs:simpleType name='empty'&gt;
    &lt;xs:restriction base='xs:string'&gt;
      &lt;xs:enumeration value=''/&gt;
    &lt;/xs:restriction&gt;
  &lt;/xs:simpleType&gt;

&lt;/xs:schema&gt;
      </pre></div>
    </div>
    <div class="indent">
<h3>11.2 <a name="schemas-items">disco#items</a>
</h3>
      <p class="caption"></p>
<div class="indent"><pre>
&lt;?xml version='1.0' encoding='UTF-8' ?&gt;

&lt;xs:schema
    xmlns:xs='http://www.w3.org/2001/XMLSchema'
    targetNamespace='http://jabber.org/protocol/disco#items'
    xmlns='http://jabber.org/protocol/disco#items'
    elementFormDefault='qualified'&gt;

  &lt;xs:annotation&gt;
    &lt;xs:documentation&gt;
      The protocol documented by this schema is defined in
      JEP-0030: http://www.jabber.org/jeps/jep-0030.html
    &lt;/xs:documentation&gt;
  &lt;/xs:annotation&gt;

  &lt;xs:element name='query'&gt;
    &lt;xs:complexType&gt;
      &lt;xs:sequence minOccurs='0'&gt;
        &lt;xs:element ref='item' minOccurs='0' maxOccurs='unbounded'/&gt;
      &lt;/xs:sequence&gt;
      &lt;xs:attribute name='node' type='xs:string' use='optional'/&gt;
    &lt;/xs:complexType&gt;
  &lt;/xs:element&gt;

  &lt;xs:element name='item'&gt;
    &lt;xs:complexType&gt;
      &lt;xs:simpleContent&gt;
        &lt;xs:extension base='empty'&gt;
          &lt;xs:attribute name='action' use='optional'&gt;
            &lt;xs:simpleType&gt;
              &lt;xs:restriction base='xs:NCName'&gt;
                &lt;xs:enumeration value='remove'/&gt;
                &lt;xs:enumeration value='update'/&gt;
              &lt;/xs:restriction&gt;
            &lt;/xs:simpleType&gt;
          &lt;/xs:attribute&gt;
          &lt;xs:attribute name='jid' type='xs:string' use='required'/&gt;
          &lt;xs:attribute name='name' type='xs:string' use='optional'/&gt;
          &lt;xs:attribute name='node' type='xs:string' use='optional'/&gt;
        &lt;/xs:extension&gt;
      &lt;/xs:simpleContent&gt;
    &lt;/xs:complexType&gt;
  &lt;/xs:element&gt;

  &lt;xs:simpleType name='empty'&gt;
    &lt;xs:restriction base='xs:string'&gt;
      &lt;xs:enumeration value=''/&gt;
    &lt;/xs:restriction&gt;
  &lt;/xs:simpleType&gt;

&lt;/xs:schema&gt;
      </pre></div>
    </div>
  <p><hr></p>
<a name="notes"></a><h2>Notes</h2>
<div class="indent">
<p><a name="nt-id2250282">1</a>. RFC 3920: Extensible Messaging and Presence Protocol (XMPP): Core &lt;<a href="http://www.ietf.org/rfc/rfc3920.txt">http://www.ietf.org/rfc/rfc3920.txt</a>&gt;.</p>
<p><a name="nt-id2250310">2</a>. JEP-0011: Jabber Browsing &lt;<a href="http://www.jabber.org/jeps/jep-0011.html">http://www.jabber.org/jeps/jep-0011.html</a>&gt;.</p>
<p><a name="nt-id2250333">3</a>. JEP-0094: Agent Information &lt;<a href="http://www.jabber.org/jeps/jep-0094.html">http://www.jabber.org/jeps/jep-0094.html</a>&gt;.</p>
<p><a name="nt-id2250375">4</a>. JEP-0134: Protocol Design Guidelines &lt;<a href="http://www.jabber.org/jeps/jep-0134.html">http://www.jabber.org/jeps/jep-0134.html</a>&gt;.</p>
<p><a name="nt-id2256660">5</a>. Simple Object Access Protocol (SOAP) &lt;<a href="http://www.w3.org/TR/SOAP/">http://www.w3.org/TR/SOAP/</a>&gt;.</p>
<p><a name="nt-id2257041">6</a>. RFC 3921: Extensible Messaging and Presence Protocol (XMPP): Instant Messaging and Presence &lt;<a href="http://www.ietf.org/rfc/rfc3921.txt">http://www.ietf.org/rfc/rfc3921.txt</a>&gt;.</p>
<p><a name="nt-id2257296">7</a>. JEP-0013: Flexible Offline Message Retrieval &lt;<a href="http://www.jabber.org/jeps/jep-0013.html">http://www.jabber.org/jeps/jep-0013.html</a>&gt;.</p>
<p><a name="nt-id2257327">8</a>. JEP-0060: Publish-Subscribe &lt;<a href="http://www.jabber.org/jeps/jep-0060.html">http://www.jabber.org/jeps/jep-0060.html</a>&gt;.</p>
<p><a name="nt-id2257682">9</a>. JEP-0118: User Tune &lt;<a href="http://www.jabber.org/jeps/jep-0118.html">http://www.jabber.org/jeps/jep-0118.html</a>&gt;.</p>
<p><a name="nt-id2257772">10</a>. JEP-0054: vcard-temp &lt;<a href="http://www.jabber.org/jeps/jep-0054.html">http://www.jabber.org/jeps/jep-0054.html</a>&gt;.</p>
<p><a name="nt-id2258004">11</a>. JEP-0055: Jabber Search &lt;<a href="http://www.jabber.org/jeps/jep-0055.html">http://www.jabber.org/jeps/jep-0055.html</a>&gt;.</p>
<p><a name="nt-id2258096">12</a>. JEP-0086: Error Condition Mappings &lt;<a href="http://www.jabber.org/jeps/jep-0086.html">http://www.jabber.org/jeps/jep-0086.html</a>&gt;.</p>
<p><a name="nt-id2258296">13</a>. The Internet Assigned Numbers Authority (IANA) is the central coordinator for the assignment of unique parameter values for Internet protocols, such as port numbers and URI schemes. For further information, see &lt;<a href="http://www.iana.org/">http://www.iana.org/</a>&gt;.</p>
<p><a name="nt-id2258380">14</a>. The Jabber Registrar maintains a list of reserved Jabber protocol namespaces as well as registries of parameters used in the context of protocols approved by the Jabber Software Foundation. For further information, see &lt;<a href="http://www.jabber.org/registrar/">http://www.jabber.org/registrar/</a>&gt;.</p>
</div>
<p><hr></p>
<a name="revs"></a><h2>Revision History</h2>
<div class="indent">
<h4>Version 2.1 (2005-03-03)</h4>
<div class="indent">Added paragraph to implementation notes about server handling of requests sent to bare JIDs. (psa)
    </div>
<h4>Version 2.0 (2004-07-20)</h4>
<div class="indent">Per a vote of the Jabber Council, advanced status to Final. (psa)
    </div>
<h4>Version 1.10 (2004-06-29)</h4>
<div class="indent">Defined security considerations; changed extended presence example to use a fictitious protocol; further specified publish feature; defined registry submissions. (psa/jjh)
    </div>
<h4>Version 1.9 (2004-05-27)</h4>
<div class="indent">Clarified error conditions. (psa)
    </div>
<h4>Version 1.8 (2004-05-21)</h4>
<div class="indent">Moved remaining feature negotiation text to JEP-0020. (psa)
    </div>
<h4>Version 1.7 (2004-05-13)</h4>
<div class="indent">Added implementation note regarding flexibility of feature and item results; final editorial cleanup. (psa)
    </div>
<h4>Version 1.6 (2004-05-11)</h4>
<div class="indent">Corrected examples of publishing available items; further clarified nature of node hierarchies. (psa)
    </div>
<h4>Version 1.5 (2004-05-10)</h4>
<div class="indent">Added clarifying note about node hierarchies. (psa)
    </div>
<h4>Version 1.4 (2004-05-07)</h4>
<div class="indent">Clarified usage of "directory"; added section defining the relationship between an entity and its associated items. (psa)
    </div>
<h4>Version 1.3 (2004-04-23)</h4>
<div class="indent">Further clarified item-publication protocol; moved some feature negotiation text to JEP-0020; added information about registry of well-known service discovery nodes; added implementation notes regarding tree-walking and large result sets; incorporated additional Call for Experience suggestions. (psa)
    </div>
<h4>Version 1.2 (2004-04-20)</h4>
<div class="indent">Editorial cleanup; incorporated some Call for Experience suggestions. (psa)
    </div>
<h4>Version 1.1 (2004-03-15)</h4>
<div class="indent">Described requirements, syntax, and use cases in a more formal manner; corrected several errors in the examples and schemas; defined Jabber Registrar procedures; added a number of references; specified XMPP error handling. (psa)
    </div>
<h4>Version 1.0 (2003-04-21)</h4>
<div class="indent">Per a vote of the Jabber Council, advanced status to Draft; also added XML schemas. (psa)
    </div>
<h4>Version 0.13 (2003-02-25)</h4>
<div class="indent">Added remarks about empty node attributes; described semantics regarding multiple identity elements. (pgm)
    </div>
<h4>Version 0.12 (2003-02-06)</h4>
<div class="indent">Added support for IQ-set; added example for disco#info to a specific node. (pgm)
    </div>
<h4>Version 0.11 (2002-12-17)</h4>
<div class="indent">Added support for the 'node' attribute per discussion on the Standards-JIG list in order to support items that are not JID-addressable. (psa)
    </div>
<h4>Version 0.10 (2002-11-21)</h4>
<div class="indent">Changed &lt;feature type='foo'/&gt; to &lt;feature var='foo'/&gt; to track changes in feature negotiation (JEP-0020); added initial registry parameters. (psa)
    </div>
<h4>Version 0.9 (2002-11-07)</h4>
<div class="indent">Added support for empty result sets in disco#item. (psa)
    </div>
<h4>Version 0.8 (2002-11-01)</h4>
<div class="indent">Removed the max, start, and total attributes for item queries (this will be handled by a generic paging JEP); added "http://jabber.org/protocol/feature-neg" namespace as a feature to signal negotiability regarding one or more features. (psa)
    </div>
<h4>Version 0.7 (2002-10-28)</h4>
<div class="indent">Cleaned up the feature text and examples. (psa)
    </div>
<h4>Version 0.6 (2002-10-27)</h4>
<div class="indent">Added the 'category' attribute to the &lt;feature/&gt; element; added security, IANA, and Jabber Registrar considerations; added a number of examples. (psa)
    </div>
<h4>Version 0.5 (2002-10-15)</h4>
<div class="indent">Total overhaul and simplification. (psa)
    </div>
<h4>Version 0.4 (2002-07-16)</h4>
<div class="indent">Major additions and fixes, many more examples. (psa)
    </div>
<h4>Version 0.3 (2002-05-30)</h4>
<div class="indent">Re-organized around use cases, made some minor fixes. (psa)
    </div>
<h4>Version 0.2 (2002-05-05)</h4>
<div class="indent">Incorporated comments from co-authors and added notes. (psa)
    </div>
<h4>Version 0.1 (2002-05-03)</h4>
<div class="indent">Initial draft. (psa)
    </div>
</div>
<p><hr></p>
<p>END</p>
</body>
</html>
