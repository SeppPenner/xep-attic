<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-loose.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>XEP-0236: Abuse Reporting</title><link rel="stylesheet" type="text/css" href="/xmpp.css" /><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" /><meta name="DC.Title" content="Abuse Reporting" /><meta name="DC.Creator" content="Peter Saint-Andre" /><meta name="DC.Description" content="This specification defines an XMPP protocol extension for reporting abusive traffic between two XMPP servers." /><meta name="DC.Publisher" content="XMPP Standards Foundation" /><meta name="DC.Contributor" content="XMPP Extensions Editor" /><meta name="DC.Date" content="2008-03-05" /><meta name="DC.Type" content="XMPP Extension Protocol" /><meta name="DC.Format" content="XHTML" /><meta name="DC.Identifier" content="XEP-0236" /><meta name="DC.Language" content="en" /><meta name="DC.Rights" content="This XMPP Extension Protocol is copyright (c) 1999 - 2008 by the XMPP Standards Foundation (XSF)." /></head><body><h1>XEP-0236: Abuse Reporting</h1><p>This specification defines an XMPP protocol extension for reporting abusive traffic between two XMPP servers.</p><hr /><p style="color:red">WARNING: This Standards-Track document is Experimental. Publication as an XMPP Extension Protocol does not imply approval of this proposal by the XMPP Standards Foundation. Implementation of the protocol described herein is encouraged in exploratory implementations, but production systems should not deploy implementations of this protocol until it advances to a status of Draft.</p><hr /><h2>Document Information</h2><p class="indent">
            Series: <a href="http://www.xmpp.org/extensions/">XEP</a><br />
            Number: 0236<br />
            Publisher: <a href="/xsf/">XMPP Standards Foundation</a><br />
            Status: 
            <a href="http://www.xmpp.org/extensions/xep-0001.html#states-Experimental">Experimental</a><br />
            Type:
            <a href="http://www.xmpp.org/extensions/xep-0001.html#types-Standards Track">Standards Track</a><br />
            Version: 0.1<br />
            Last Updated: 2008-03-05<br />
                Approving Body: <a href="http://www.xmpp.org/council/">XMPP Council</a><br />Dependencies: XMPP Core, XEP-0030<br />
                Supersedes: None<br />
                Superseded By: None<br />
            Short Name: NOT YET ASSIGNED<br />
              Wiki Page: &lt;<a href="http://wiki.jabber.org/index.php/Abuse Reporting (XEP-0236)">http://wiki.jabber.org/index.php/Abuse Reporting (XEP-0236)</a>&gt;
            </p><hr /><h2>Author Information</h2><div class="indent"><h3>Peter Saint-Andre</h3><p class="indent">
        JabberID: 
        <a href="xmpp:stpeter@jabber.org">stpeter@jabber.org</a><br />
        URI: 
        <a href="https://stpeter.im/">https://stpeter.im/</a><br /></p></div><hr /><h2>Legal Notices</h2><div class="indent"><h3>Copyright</h3>This XMPP Extension Protocol is copyright (c) 1999 - 2008 by the XMPP Standards Foundation (XSF).<h3>Permissions</h3>Permission is hereby granted, free of charge, to any person obtaining a copy of this specification (the "Specification"), to make use of the Specification without restriction, including without limitation the rights to implement the Specification in a software program, deploy the Specification in a network service, and copy, modify, merge, publish, translate, distribute, sublicense, or sell copies of the Specification, and to permit persons to whom the Specification is furnished to do so, subject to the condition that the foregoing copyright notice and this permission notice shall be included in all copies or substantial portions of the Specification. Unless separate permission is granted, modified works that are redistributed shall not contain misleading information regarding the authors, title, number, or publisher of the Specification, and shall not claim endorsement of the modified works by the authors, any organization or project to which the authors belong, or the XMPP Standards Foundation.<h3>Disclaimer of Warranty</h3><span style="font-weight: bold">## NOTE WELL: This Specification is provided on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, express or implied, including, without limitation, any warranties or conditions of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A PARTICULAR PURPOSE. In no event shall the XMPP Standards Foundation or the authors of this Specification be liable for any claim, damages, or other liability, whether in an action of contract, tort, or otherwise, arising from, out of, or in connection with the Specification or the implementation, deployment, or other use of the Specification. ##</span><h3>Limitation of Liability</h3>In no event and under no legal theory, whether in tort (including negligence), contract, or otherwise, unless required by applicable law (such as deliberate and grossly negligent acts) or agreed to in writing, shall the XMPP Standards Foundation or any author of this Specification be liable for damages, including any direct, indirect, special, incidental, or consequential damages of any character arising out of the use or inability to use the Specification (including but not limited to damages for loss of goodwill, work stoppage, computer failure or malfunction, or any and all other commercial damages or losses), even if the XMPP Standards Foundation or such author has been advised of the possibility of such damages.<h3>IPR Conformance</h3>This XMPP Extension Protocol has been contributed in full conformance with the XSF's Intellectual Property Rights Policy (a copy of which may be found at &lt;<a href="http://www.xmpp.org/extensions/ipr-policy.shtml">http://www.xmpp.org/extensions/ipr-policy.shtml</a>&gt; or obtained by writing to XSF, P.O. Box 1641, Denver, CO 80201 USA).</div><hr /><h2>Discussion Venue</h2><p class="indent">The preferred venue for discussion of this document is the Standards discussion list: &lt;<a href="http://mail.jabber.org/mailman/listinfo/standards">http://mail.jabber.org/mailman/listinfo/standards</a>&gt;.</p><p class="indent">Errata may be sent to &lt;<a href="mailto:editor@xmpp.org">editor@xmpp.org</a>&gt;.</p><h2>Relation to XMPP</h2><p class="indent">The Extensible Messaging and Presence Protocol (XMPP) is defined in the XMPP Core (RFC 3920) and XMPP IM (RFC 3921) specifications contributed by the XMPP Standards Foundation to the Internet Standards Process, which is managed by the Internet Engineering Task Force in accordance with RFC 2026. Any protocol defined in this document has been developed outside the Internet Standards Process and is to be understood as an extension to XMPP rather than as an evolution, development, or modification of XMPP itself.</p><h2>Conformance Terms</h2><p class="indent">The following keywords as used in this document are to be interpreted as described in <a href="http://www.ietf.org/rfc/rfc2119.txt">RFC 2119</a>: "MUST", "SHALL", "REQUIRED"; "MUST NOT", "SHALL NOT"; "SHOULD", "RECOMMENDED"; "SHOULD NOT", "NOT RECOMMENDED"; "MAY", "OPTIONAL".</p><hr /><h2>Table of Contents</h2><div class="indent"><p><br />1.  <a href="#intro">Introduction</a><br />2.  <a href="#syntax">Syntax</a><br />3.  <a href="#report">Abuse Report</a><br />   
      3.1.  <a href="#generation">Generation</a><br />   
      3.2.  <a href="#processing">Processing</a><br />      
      3.2.1.  <a href="#processing-notsupported">Abuse Reporting Not Supported</a><br />      
      3.2.2.  <a href="#processing-notfound">Sender(s) Not Found</a><br />      
      3.2.3.  <a href="#processing-accept">Abuse Report Accepted</a><br />4.  <a href="#stanza">Stanza Error</a><br />5.  <a href="#stream">Stream Error</a><br />6.  <a href="#disco">Discovering Support</a><br />7.  <a href="#security">Security Considerations</a><br />   
      7.1.  <a href="#security-dos">Denial of Service Attacks</a><br />   
      7.2.  <a href="#security-mitm">Man in the Middle Attacks</a><br />8.  <a href="#iana">IANA Considerations</a><br />9.  <a href="#registrar">XMPP Registrar Considerations</a><br />   
      9.1.  <a href="#ns">Protocol Namespaces</a><br />   
      9.2.  <a href="#registrar-apperror">Application-Specific Errors</a><br />10.  <a href="#schema">XML Schema</a><br /><a href="#notes">Notes</a><br /><a href="#revs">Revision History</a></p></div><hr /><h2>1.
       <a name="intro" id="intro">Introduction</a></h2>
  <p class="" style="">Unfortunately, not all XMPP entities are well-behaved. Currently, if an XMPP entity sends abusive stanzas over a server-to-server connection, there is no way for the receiving server to inform the sending server that the sender is generating abusive traffic. In practice, the receiving server may need to terminate the server-to-server connection (again without explicitly informing the sending server about the reason for the termination) rather than continue to accept the abusive traffic.</p>
  <p class="" style="">This situation is far from desirable. Therefore, this specification defines three small XMPP protocol functions that can help to improve the reliability of server-to-server connections:</p>
  <ol start="" class="" style="">
    <li class="" style="">A method by which the receiving server can send an abuse report to the sending server, including the JID(s) of the sender(s).</li>
    <li class="" style="">An application-specific stanza error condition that can be combined with the standard &lt;not-acceptable/&gt; stanza error condition to inform the sending server that a particular XMPP stanza is considered abusive.</li>
    <li class="" style="">An application-specific stream error condition that can be combined with the standard &lt;policy-violation/&gt; stream error condition to inform the sending server about the reason for termination of an XML stream.</li>
  </ol>
<h2>2.
       <a name="syntax" id="syntax">Syntax</a></h2>
  <p class="" style="">An abuse report MUST be sent in an IQ stanza of type "set" containing an &lt;abuse/&gt; element qualified by the 'urn:xmpp:tmp:abuse' namespace (see <a href="#ns">Protocol Namespaces</a> regarding issuance of one or more permanent namespaces). The allowable children of the &lt;abuse/&gt; element are:</p>
  <ul class="" style="">
    <li class="" style="">One or more &lt;jid/&gt; elements whose XML character data specifies the JID(s) of the abusive sender(s)</li>
    <li class="" style="">An optional &lt;reason/&gt; element that specifies the reason for the abuse report, via a machine-readable abuse condition defined in this specification, (optionally) human-readable text about the report, and (optionally) an application-specific condition defined outside this specification.</li>
  </ul>
  <p class="" style="">This specification intentionally does not define exactly what constitutes abuse, since "abuse is in the eye of the beholder". However, the following machine-readable conditions are defined as children of the &lt;reason/&gt; element.</p>
  <p class="caption"><a name="table-1" id="table-1"></a>Table 1: Abuse Conditions</p><table border="1" cellpadding="3" cellspacing="0">
    <tr class="body">
      <th colspan="" rowspan="">Condition</th>
      <th colspan="" rowspan="">Definition</th>
    </tr>
    <tr class="body">
      <td colspan="" rowspan="">&lt;gateway/&gt;</td>
      <td colspan="" rowspan="">Attempting to inappropriately use a gateway on the receiving server (see <span class="ref" style=""><a href="http://www.xmpp.org/extensions/xep-0100.html">Gateway Interaction</a></span>  [<a href="#nt-id2251372">1</a>])</td>
    </tr>
    <tr class="body">
      <td colspan="" rowspan="">&lt;muc/&gt;</td>
      <td colspan="" rowspan="">Attempting to take over or otherwise abuse <span class="ref" style=""><a href="http://www.xmpp.org/extensions/xep-0045.html">Multi-User Chat</a></span>  [<a href="#nt-id2251551">2</a>] rooms on the receiving server</td>
    </tr>
    <tr class="body">
      <td colspan="" rowspan="">&lt;proxy/&gt;</td>
      <td colspan="" rowspan="">Attempting to inappropriately use a <span class="ref" style=""><a href="http://www.xmpp.org/extensions/xep-0065.html">SOCKS5 Bytestreams</a></span>  [<a href="#nt-id2251583">3</a>] proxy, TURN server, or other proxy on the receiving server</td>
    </tr>
    <tr class="body">
      <td colspan="" rowspan="">&lt;pubsub/&gt;</td>
      <td colspan="" rowspan="">Attempting to inappropriately use a <span class="ref" style=""><a href="http://www.xmpp.org/extensions/xep-0060.html">Publish-Subscribe</a></span>  [<a href="#nt-id2251404">4</a>] service on the receiving server</td>
    </tr>
    <tr class="body">
      <td colspan="" rowspan="">&lt;service/&gt;</td>
      <td colspan="" rowspan="">Attempting to inappropriately use any other kind of service on the receiving server</td>
    </tr>
    <tr class="body">
      <td colspan="" rowspan="">&lt;spam/&gt;</td>
      <td colspan="" rowspan="">Sending spam (unsolicited bulk messages)</td>
    </tr>
    <tr class="body">
      <td colspan="" rowspan="">&lt;stanza-too-big/&gt;</td>
      <td colspan="" rowspan="">Sending extremely large stanzas</td>
    </tr>
    <tr class="body">
      <td colspan="" rowspan="">&lt;too-many-recipients/&gt;</td>
      <td colspan="" rowspan="">Sending messages that contain too many recipients (see <span class="ref" style=""><a href="http://www.xmpp.org/extensions/xep-0033.html">Extended Stanza Addressing</a></span>  [<a href="#nt-id2251496">5</a>])</td>
    </tr>
    <tr class="body">
      <td colspan="" rowspan="">&lt;too-many-stanzas/&gt;</td>
      <td colspan="" rowspan="">Sending an extremely large number of stanzas</td>
    </tr>
    <tr class="body">
      <td colspan="" rowspan="">&lt;unacceptable-payload/&gt;</td>
      <td colspan="" rowspan="">Sending messages that contain unacceptable payloads such as malicious executables</td>
    </tr>
    <tr class="body">
      <td colspan="" rowspan="">&lt;unacceptable-text/&gt;</td>
      <td colspan="" rowspan="">Sending messages that contain unacceptable human-readable text</td>
    </tr>
    <tr class="body">
      <td colspan="" rowspan="">&lt;undefined-abuse/&gt;</td>
      <td colspan="" rowspan="">The abuse condition is undefined (should be used with an application-specific condition)</td>
    </tr>
  </table>
  <p class="" style="">Note: The foregoing list of conditions is not exhaustive. The list may be augmented or otherwise modified in a future version of this specification as a result of implementation and deployment experience.</p>
<h2>3.
       <a name="report" id="report">Abuse Report</a></h2>
  <div class="indent"><h3>3.1 <a name="generation" id="generation">Generation</a></h3>
    <p class="" style="">If an XMPP server receives abusive stanzas over a server-to-server connection, the receiving server SHOULD send an abuse report to the sending server.</p>
    <p class="caption"><a name="example-1" id="example-1"></a>Example 1. Abuse Report</p><div class="indent"><pre>
&lt;iq from='example.org'
    id='rep1'
    to='example.com'
    type='set'&gt;
  &lt;abuse xmlns='urn:xmpp:tmp:abuse'&gt;
    &lt;jid&gt;abuser@example.com/foo&lt;/jid&gt;
    &lt;reason&gt;
      &lt;condition&gt;
        &lt;muc/&gt;
      &lt;/condition&gt;
    &lt;/reason&gt;
  &lt;/abuse&gt;
&lt;/iq&gt;
    </pre></div>
  </div>
  <div class="indent"><h3>3.2 <a name="processing" id="processing">Processing</a></h3>
    <p class="" style="">Upon receiving the abuse report, the sending server MUST proceed as follows.</p>
    <div class="indent"><h3>3.2.1 <a name="processing-notsupported" id="processing-notsupported">Abuse Reporting Not Supported</a></h3>
      <p class="" style="">If the sending server does not understand the abuse reporting protocol, it MUST return a &lt;service-unavailable/&gt; error to the receiving server.</p>
      <p class="caption"><a name="example-2" id="example-2"></a>Example 2. Abuse reporting not supported</p><div class="indent"><pre>
&lt;iq from='example.com'
    id='rep1'
    to='example.org'
    type='error'&gt;
  &lt;error type='cancel'&gt;
    &lt;service-unavailable xmlns='urn:ietf:params:xml:ns:xmpp-stanzas'/&gt;
  &lt;/error&gt;
&lt;/iq&gt;
      </pre></div>
    </div>
    <div class="indent"><h3>3.2.2 <a name="processing-notfound" id="processing-notfound">Sender(s) Not Found</a></h3>
      <p class="" style="">If none of the JIDs contained in the abuse report exist at the sending server, the sending server MUST return an &lt;item-not-found/&gt; error to the receiving server.</p>
      <p class="caption"><a name="example-3" id="example-3"></a>Example 3. Senders not found</p><div class="indent"><pre>
&lt;iq from='example.com'
    id='rep1'
    to='example.org'
    type='error'&gt;
  &lt;error type='cancel'&gt;
    &lt;item-not-found xmlns='urn:ietf:params:xml:ns:xmpp-stanzas'/&gt;
  &lt;/error&gt;
&lt;/iq&gt;
      </pre></div>
    </div>
    <div class="indent"><h3>3.2.3 <a name="processing-accept" id="processing-accept">Abuse Report Accepted</a></h3>
      <p class="" style="">If the sending server accepts the abuse report for one or more JIDs, it MUST return an IQ stanza of type "result" to the receiving server.</p>
      <p class="caption"><a name="example-4" id="example-4"></a>Example 4. Abuse report accepted</p><div class="indent"><pre>
&lt;iq from='example.com'
    id='rep1'
    to='example.org'
    type='result'/&gt;
      </pre></div>
      <p class="" style="">This specification does not define how a sending server shall behave when it receives an abuse report. In general it is expected that the sending server (1) will notify the human administrators of the server in some implementation-specific or deployment-specific fashion, and (2) may use the abuse report in an automated fashion (e.g., as input to a rate-limiting algorithm, reputation system, or decision about temporarily suspending the privileges of the sending entity or entities). In addition, the sending server MAY the report to trusted parties such as third-party reporting services.</p>
    </div>
  </div>
<h2>4.
       <a name="stanza" id="stanza">Stanza Error</a></h2>
  <p class="" style="">The receiving server MAY report that a particular stanza is considered abusive. The stanza error condition MUST be &lt;not-acceptable/&gt; and the error stanza MUST include an application-specific error condition of &lt;abuse/&gt; qualified by the 'urn:xmpp:tmp:abuse' (see <a href="#ns">Protocol Namespaces</a> regarding issuance of one or more permanent namespaces). The &lt;abuse/&gt; element MUST include one or more &lt;jid/&gt; elements whose XML character data specifies the JID(s) of the abusive sender(s).</p>
  <p class="caption"><a name="example-5" id="example-5"></a>Example 5. Abusive stanza</p><div class="indent"><pre>
&lt;message from='abuser@example.org/foo'
         to='victim@example.org'&gt;
  [ ... some abusive payload here ... ]
&lt;/message&gt;
  </pre></div>
  <p class="caption"><a name="example-6" id="example-6"></a>Example 6. Stanza error</p><div class="indent"><pre>
&lt;message from='example.com'
         to='example.org'&gt;
  &lt;error type='cancel'&gt;
    &lt;not-acceptable xmlns='urn:ietf:params:xml:ns:xmpp-stanzas'/&gt;
  &lt;/error&gt;
  &lt;abuse xmlns='urn:xmpp:tmp:abuse'&gt;
    &lt;jid&gt;abuser@example.com/foo&lt;/jid&gt;
    &lt;reason&gt;
      &lt;condition&gt;
        &lt;unacceptable-payload/&gt;
      &lt;/condition&gt;
    &lt;/reason&gt;
  &lt;/abuse&gt;
&lt;/message&gt;
  </pre></div>
<h2>5.
       <a name="stream" id="stream">Stream Error</a></h2>
  <p class="" style="">If the sending entity continues to generate abusive stanzas via the sending server, the receiving server MAY close the stream between the receiving server and the sending server. The stream error condition MUST be &lt;policy-violation/&gt; and the stream error MUST include an application-specific error condition of &lt;abuse/&gt; qualified by the 'urn:xmpp:tmp:abuse'. The &lt;abuse/&gt; element MUST include one or more &lt;jid/&gt; elements whose XML character data specifies the JID(s) of the abusive sender(s).</p>
  <p class="caption"><a name="example-7" id="example-7"></a>Example 7. Stream Error</p><div class="indent"><pre>
&lt;stream:error&gt;
  &lt;policy-violation xmlns='urn:ietf:params:xml:ns:xmpp-streams'/&gt;
  &lt;abuse xmlns='urn:xmpp:tmp:abuse'&gt;
    &lt;jid&gt;abuser@example.com/foo&lt;/jid&gt;
    &lt;reason&gt;
      &lt;condition&gt;
        &lt;too-many-stanzas/&gt;
      &lt;/condition&gt;
    &lt;/reason&gt;
  &lt;/abuse&gt;
&lt;/stream:error&gt;
&lt;/stream:stream&gt;
  </pre></div>
  <p class="" style="">The receiving entity then SHOULD terminate the TCP connection between the receiving server and the sending server.</p>
<h2>6.
       <a name="disco" id="disco">Discovering Support</a></h2>
  <p class="" style="">If a server supports the abuse reporting protocol, it MUST report that fact by including a service discovery feature of "urn:xmpp:tmp:abuse" (see <a href="#ns">Protocol Namespaces</a> regarding issuance of one or more permanent namespaces) in response to a <span class="ref" style=""><a href="http://www.xmpp.org/extensions/xep-0030.html">Service Discovery</a></span>  [<a href="#nt-id2261601">6</a>] information request:</p>
  <p class="caption"><a name="example-8" id="example-8"></a>Example 8. Service Discovery information request</p><div class="indent"><pre>
&lt;iq from='example.org'
    id='disco1'
    to='example.com'
    type='get'&gt;
  &lt;query xmlns='http://jabber.org/protocol/disco#info'/&gt;
&lt;/iq&gt;
  </pre></div>
  <p class="caption"><a name="example-9" id="example-9"></a>Example 9. Service Discovery information response</p><div class="indent"><pre>
&lt;iq from='example.com'
    id='disco1'
    to='example.org'
    type='result'&gt;
  &lt;query xmlns='http://jabber.org/protocol/disco#info'&gt;
    ...
    &lt;feature var='urn:xmpp:tmp:abuse'/&gt;
    ...
  &lt;/query&gt;
&lt;/iq&gt;
  </pre></div>
<h2>7.
       <a name="security" id="security">Security Considerations</a></h2>
  <div class="indent"><h3>7.1 <a name="security-dos" id="security-dos">Denial of Service Attacks</a></h3>
    <p class="" style="">It is possible for an abusive sender to launch a denial of service attack against legitimate users of the sending server by generating abusive traffic over the server-to-server connection (in fact such attacks have already been observed on XMPP networks). Although use of the abuse reporting protocol does not completely prevent such attacks, it may at least enable sending servers to react to abusive traffic in close to real time, thus helping to "heal" the network when denial of service attacks are launched.</p>
  </div>
  <div class="indent"><h3>7.2 <a name="security-mitm" id="security-mitm">Man in the Middle Attacks</a></h3>
    <p class="" style="">If a malicious entity can inject information into the server-to-server connection, it can falsely send abuse reports to the sending server. Therefore the connection SHOULD be encrypted using Transport Layer Security as specified in <span class="ref" style=""><a href="http://tools.ietf.org/html/rfc3920">XMPP Core</a></span>  [<a href="#nt-id2261690">7</a>].</p>
  </div>
<h2>8.
       <a name="iana" id="iana">IANA Considerations</a></h2>
  <p class="" style="">This document requires no interaction with the <span class="ref" style=""><a href="http://www.iana.org/">Internet Assigned Numbers Authority (IANA)</a></span>  [<a href="#nt-id2261725">8</a>].</p>
<h2>9.
       <a name="registrar" id="registrar">XMPP Registrar Considerations</a></h2>
  <div class="indent"><h3>9.1 <a name="ns" id="ns">Protocol Namespaces</a></h3>
    <p class="" style="">Until this specification advances to a status of Draft, its associated namespace shall be "urn:xmpp:tmp:abuse"; upon advancement of this specification, the <span class="ref" style=""><a href="http://www.xmpp.org/registrar/">XMPP Registrar</a></span>  [<a href="#nt-id2261784">9</a>] shall issue a permanent namespace in accordance with the process defined in Section 4 of <span class="ref" style=""><a href="http://www.xmpp.org/extensions/xep-0053.html">XMPP Registrar Function</a></span>  [<a href="#nt-id2261817">10</a>].</p>
  </div>
  <div class="indent"><h3>9.2 <a name="registrar-apperror" id="registrar-apperror">Application-Specific Errors</a></h3>
    <p class="" style="">The XMPP Registrar shall add &lt;abuse/&gt; to its registry of application-specific error conditions (see &lt;<a href="http://www.xmpp.org/registrar/errors.html">http://www.xmpp.org/registrar/errors.html</a>&gt;), where the element is qualified by the 'urn:xmpp:tmp:abuse' namespace (see <a href="#ns">Protocol Namespaces</a> regarding issuance of one or more permanent namespaces).</p>
    <p class="" style="">The registry submission is as follows:</p>
    <p class="caption"></p><div class="indent"><pre>
&lt;condition&gt;
  &lt;ns&gt;urn:xmpp:tmp:abuse&lt;/ns&gt;
  &lt;element&gt;abuse&lt;/element&gt;
  &lt;desc&gt;the sending entity has generated traffic that the receiving server considers abusive&lt;/desc&gt;
  &lt;doc&gt;XEP-xxxx&lt;/doc&gt;
&lt;/condition&gt;
    </pre></div>
  </div>
<h2>10.
       <a name="schema" id="schema">XML Schema</a></h2>
  <p class="caption"></p><div class="indent"><pre>
&lt;?xml version='1.0' encoding='UTF-8'?&gt;

&lt;xs:schema
    xmlns:xs='http://www.w3.org/2001/XMLSchema'
    targetNamespace='urn:xmpp:tmp:abuse'
    xmlns='urn:xmpp:tmp:abuse'
    elementFormDefault='qualified'&gt;

  &lt;xs:element name='abuse'&gt;
    &lt;xs:complexType&gt;
      &lt;xs:sequence&gt;
        &lt;xs:element name='jid' type='xs:string' minOccurs='1' maxOccurs='unbounded'/&gt;
        &lt;xs:element ref='reason' minOccurs='0'/&gt;
      &lt;/xs:sequence&gt;
    &lt;/xs:complexType&gt;
  &lt;/xs:element&gt;

  &lt;xs:element name='reason'&gt;
    &lt;xs:complexType&gt;
      &lt;xs:sequence&gt;
        &lt;xs:element ref='condition' minOccurs='0' maxOccurs='1'/&gt;
        &lt;xs:element name='text' type='xs:string' minOccurs='0' maxOccurs='1'/&gt;
        &lt;xs:any namespace='##other' minOccurs='0' maxOccurs='1'/&gt;
      &lt;/xs:sequence&gt;
    &lt;/xs:complexType&gt;
  &lt;/xs:element&gt;

  &lt;xs:element name='condition'&gt;
    &lt;xs:complexType&gt;
      &lt;xs:choice&gt;
        &lt;xs:element name='gateway' type='empty'/&gt;
        &lt;xs:element name='muc' type='empty'/&gt;
        &lt;xs:element name='proxy' type='empty'/&gt;
        &lt;xs:element name='pubsub' type='empty'/&gt;
        &lt;xs:element name='service' type='empty'/&gt;
        &lt;xs:element name='spam' type='empty'/&gt;
        &lt;xs:element name='stanza-too-big' type='empty'/&gt;
        &lt;xs:element name='too-many-recipients' type='empty'/&gt;
        &lt;xs:element name='too-many-stanzas' type='empty'/&gt;
        &lt;xs:element name='unacceptable-payload' type='empty'/&gt;
        &lt;xs:element name='unacceptable-text' type='empty'/&gt;
        &lt;xs:element name='undefined-abuse' type='empty'/&gt;
      &lt;/xs:choice&gt;
    &lt;/xs:complexType&gt;
  &lt;/xs:element&gt;

  &lt;xs:simpleType name='empty'&gt;
    &lt;xs:restriction base='xs:string'&gt;
      &lt;xs:enumeration value=''/&gt;
    &lt;/xs:restriction&gt;
  &lt;/xs:simpleType&gt;

&lt;/xs:schema&gt;
  </pre></div>
<hr /><h2><a name="notes" id="notes"></a>Notes</h2><div class="indent"><p><a name="nt-id2251372" id="nt-id2251372">1</a>. XEP-0100: Gateway Interaction &lt;<a href="http://www.xmpp.org/extensions/xep-0100.html">http://www.xmpp.org/extensions/xep-0100.html</a>&gt;.</p><p><a name="nt-id2251551" id="nt-id2251551">2</a>. XEP-0045: Multi-User Chat &lt;<a href="http://www.xmpp.org/extensions/xep-0045.html">http://www.xmpp.org/extensions/xep-0045.html</a>&gt;.</p><p><a name="nt-id2251583" id="nt-id2251583">3</a>. XEP-0065: SOCKS5 Bytestreams &lt;<a href="http://www.xmpp.org/extensions/xep-0065.html">http://www.xmpp.org/extensions/xep-0065.html</a>&gt;.</p><p><a name="nt-id2251404" id="nt-id2251404">4</a>. XEP-0060: Publish-Subscribe &lt;<a href="http://www.xmpp.org/extensions/xep-0060.html">http://www.xmpp.org/extensions/xep-0060.html</a>&gt;.</p><p><a name="nt-id2251496" id="nt-id2251496">5</a>. XEP-0033: Extended Stanza Addressing &lt;<a href="http://www.xmpp.org/extensions/xep-0033.html">http://www.xmpp.org/extensions/xep-0033.html</a>&gt;.</p><p><a name="nt-id2261601" id="nt-id2261601">6</a>. XEP-0030: Service Discovery &lt;<a href="http://www.xmpp.org/extensions/xep-0030.html">http://www.xmpp.org/extensions/xep-0030.html</a>&gt;.</p><p><a name="nt-id2261690" id="nt-id2261690">7</a>. RFC 3920: Extensible Messaging and Presence Protocol (XMPP): Core &lt;<a href="http://tools.ietf.org/html/rfc3920">http://tools.ietf.org/html/rfc3920</a>&gt;.</p><p><a name="nt-id2261725" id="nt-id2261725">8</a>. The Internet Assigned Numbers Authority (IANA) is the central coordinator for the assignment of unique parameter values for Internet protocols, such as port numbers and URI schemes. For further information, see &lt;<a href="http://www.iana.org/">http://www.iana.org/</a>&gt;.</p><p><a name="nt-id2261784" id="nt-id2261784">9</a>. The XMPP Registrar maintains a list of reserved protocol namespaces as well as registries of parameters used in the context of XMPP extension protocols approved by the XMPP Standards Foundation. For further information, see &lt;<a href="http://www.xmpp.org/registrar/">http://www.xmpp.org/registrar/</a>&gt;.</p><p><a name="nt-id2261817" id="nt-id2261817">10</a>. XEP-0053: XMPP Registrar Function &lt;<a href="http://www.xmpp.org/extensions/xep-0053.html">http://www.xmpp.org/extensions/xep-0053.html</a>&gt;.</p></div><hr /><h2><a name="revs" id="revs"></a>Revision History</h2><div class="indent"><h4>Version 0.1 (2008-03-05)</h4><div class="indent"><p class="" style="">Initial published version.</p> (psa)
    </div><h4>Version 0.0.3 (2008-02-29)</h4><div class="indent"><p class="" style="">Added reason element containing machine-readable conditions and optional human-readable text; added note about forwarding of abuse reports.</p> (psa)
    </div><h4>Version 0.0.2 (2008-02-26)</h4><div class="indent"><p class="" style="">Limited scope to reporting between two servers; more clearly defined what is abusive; changed protocol to use IQ request-response exchange; limited use of error condition to stream termination.</p> (psa)
    </div><h4>Version 0.0.1 (2008-02-19)</h4><div class="indent"><p class="" style="">First draft.</p> (psa)
    </div></div><hr /><p>END</p></body></html>
