<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>XEP-0177: Jingle Raw UDP Transport</title>
<link rel="stylesheet" type="text/css" href="/xmpp.css">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico">
<meta name="DC.Title" content="Jingle Raw UDP Transport">
<meta name="DC.Creator" content="Joe Beda">
<meta name="DC.Creator" content="Peter Saint-Andre">
<meta name="DC.Creator" content="Scott Ludwig">
<meta name="DC.Creator" content="Joe Hildebrand">
<meta name="DC.Creator" content="Sean Egan">
<meta name="DC.Description" content="This document defines a Jingle transport method that results in sending data over a raw User Datagram Protocol (UDP) connection.">
<meta name="DC.Publisher" content="Jabber Software Foundation">
<meta name="DC.Contributor" content="XMPP Extensions Editor">
<meta name="DC.Date" content="2006-10-31">
<meta name="DC.Type" content="XMPP Extension Protocol">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="XEP-0177">
<meta name="DC.Language" content="en">
<meta name="DC.Rights" content="This XMPP Extension Protocol is copyright 1999 - 2006 by the Jabber Software Foundation (JSF) and is in full conformance with the JSF's Intellectual Property Rights Policy &lt;http://www.xmpp.org/extensions/ipr-policy.shtml&gt;. This material may be distributed only subject to the terms and conditions set forth in the Creative Commons Attribution License (&lt;http://creativecommons.org/licenses/by/2.5/&gt;).">
</head>
<body>
<h1>XEP-0177: Jingle Raw UDP Transport</h1>
<p>This document defines a Jingle transport method that results in sending data over a raw User Datagram Protocol (UDP) connection.</p>
<p><hr></p>
<p style="color:red">NOTICE: This document is currently within Last Call or under consideration by the XMPP Council for advancement to the next stage in the JSF standards process.</p>
<p><hr></p>
<h2>XEP Information</h2>
<p class="indent">
            Status: 
            <a href="http://www.xmpp.org/extensions/xep-0001.html#states-Proposed">Proposed</a><br>
            Type:
            <a href="http://www.xmpp.org/extensions/xep-0001.html#types-Standards%20Track">Standards Track</a><br>
            Number: 0177<br>
            Version: 0.3<br>
            Last Updated: 2006-10-31<br>
            Publishing Organization: <a href="http://www.jabber.org/jsf/">Jabber Software Foundation</a><br>
                Approving Body: <a href="http://www.jabber.org/council/">XMPP Council</a><br>Dependencies: XMPP Core, XEP-0166<br>
                Supersedes: None<br>
                Superseded By: None<br>
            Short Name: raw-udp<br>
              Wiki Page: &lt;<a href="http://wiki.jabber.org/index.php/Jingle%20Raw%20UDP%20Transport%20(XEP-0177)">http://wiki.jabber.org/index.php/Jingle Raw UDP Transport (XEP-0177)</a>&gt;
            </p>
<h2>Author Information</h2>
<div class="indent">
<h3>Joe Beda</h3>
<p class="indent">
        Email:
        <a href="mailto:jbeda@google.com">jbeda@google.com</a><br>
        JID: 
        <a href="xmpp:jbeda@google.com">jbeda@google.com</a></p>
<h3>Peter Saint-Andre</h3>
<p class="indent">
        Email:
        <a href="mailto:stpeter@jabber.org">stpeter@jabber.org</a><br>
        JID: 
        <a href="xmpp:stpeter@jabber.org">stpeter@jabber.org</a></p>
<h3>Scott Ludwig</h3>
<p class="indent">
        Email:
        <a href="mailto:scottlu@google.com">scottlu@google.com</a><br>
        JID: 
        <a href="xmpp:scottlu@google.com">scottlu@google.com</a></p>
<h3>Joe Hildebrand</h3>
<p class="indent">
        Email:
        <a href="mailto:jhildebrand@jabber.com">jhildebrand@jabber.com</a><br>
        JID: 
        <a href="xmpp:hildjj@jabber.org">hildjj@jabber.org</a></p>
<h3>Sean Egan</h3>
<p class="indent">
        Email:
        <a href="mailto:seanegan@google.com">seanegan@google.com</a><br>
        JID: 
        <a href="xmpp:seanegan@google.com">seanegan@google.com</a></p>
</div>
<h2>Legal Notice</h2>
<p class="indent">This XMPP Extension Protocol is copyright 1999 - 2006 by the <a href="http://www.jabber.org/jsf/">Jabber Software Foundation</a> (JSF) and is in full conformance with the JSF's Intellectual Property Rights Policy &lt;<a href="http://www.xmpp.org/extensions/ipr-policy.shtml">http://www.xmpp.org/extensions/ipr-policy.shtml</a>&gt;. This material may be distributed only subject to the terms and conditions set forth in the Creative Commons Attribution License (&lt;<a href="http://creativecommons.org/licenses/by/2.5/">http://creativecommons.org/licenses/by/2.5/</a>&gt;).</p>
<h2>Discussion Venue</h2>
<p class="indent">The preferred venue for discussion of this document is the Standards-JIG discussion list: &lt;<a href="http://mail.jabber.org/mailman/listinfo/standards-jig">http://mail.jabber.org/mailman/listinfo/standards-jig</a>&gt;.</p>
<h2>Relation to XMPP</h2>
<p class="indent">The Extensible Messaging and Presence Protocol (XMPP) is defined in the XMPP Core (RFC 3920) and XMPP IM (RFC 3921) specifications contributed by the Jabber Software Foundation to the Internet Standards Process, which is managed by the Internet Engineering Task Force in accordance with RFC 2026. Any protocol defined in this document has been developed outside the Internet Standards Process and is to be understood as an extension to XMPP rather than as an evolution, development, or modification of XMPP itself.</p>
<h2>Conformance Terms</h2>
<p class="indent">The following keywords as used in this document are to be interpreted as described in RFC 2119: "MUST", "SHALL", "REQUIRED"; "MUST NOT", "SHALL NOT"; "SHOULD", "RECOMMENDED"; "SHOULD NOT", "NOT RECOMMENDED"; "MAY", "OPTIONAL".</p>
<p><hr></p>
<h2>Table of Contents</h2>
<div class="indent"><dl>
<dt>1.  <a href="#intro">Introduction</a>
</dt>
<dt>2.  <a href="#reqs">Requirements</a>
</dt>
<dt>3.  <a href="#protocol">Protocol Description</a>
</dt>
<dl>
<dt>3.1.  <a href="#protocol-initiate">Transport Initiation</a>
</dt>
<dt>3.2.  <a href="#protocol-response">Receiver Response</a>
</dt>
<dt>3.3.  <a href="#protocol-addresses">Exchanging Address Information</a>
</dt>
<dt>3.4.  <a href="#protocol-info">Informational Messages</a>
</dt>
</dl>
<dt>4.  <a href="#security">Security Considerations</a>
</dt>
<dl><dt>4.1.  <a href="#security-e2e">End-to-End Data Encryption</a>
</dt></dl>
<dt>5.  <a href="#iana">IANA Considerations</a>
</dt>
<dt>6.  <a href="#registrar">XMPP Registrar Considerations</a>
</dt>
<dl>
<dt>6.1.  <a href="#registrar-ns">Protocol Namespaces</a>
</dt>
<dt>6.2.  <a href="#registrar-transports">Jingle Transport Methods</a>
</dt>
</dl>
<dt>7.  <a href="#schema">XML Schema</a>
</dt>
<dt><a href="#notes">Notes</a></dt>
<dt><a href="#revs">Revision History</a></dt>
</dl></div>
<p><hr></p>
<h2>1.
       <a name="intro">Introduction</a>
</h2>
  <p class="" style=""><span class="ref" style="">Jingle</span>  [<a href="#nt-id2251752">1</a>] defines a framework for negotiating and managing out-of-band data sessions over XMPP. In order to provide a flexible framework, the base Jingle specification defines neither data transport methods nor content formats, leaving that up to separate specifications. The current document defines a transport method for establishing and managing data between XMPP entities using a raw User Datagram Protocol (UDP) connection (see <span class="ref" style="">RFC 768</span>  [<a href="#nt-id2259977">2</a>]).</p>
<h2>2.
       <a name="reqs">Requirements</a>
</h2>
  <p class="" style="">The Jingle transport method defined herein is designed to meet the following requirements:</p>
  <ol start="" type="">
    <li>Make it possible to establish and manage out-of-band connections between two XMPP entities over the IP address and port that the initiator considers most likely to succeed.</li>
    <li>Make it relatively easy to implement support in standard Jabber/XMPP clients.</li>
    <li>Where communication with non-XMPP entities is needed, push as much complexity as possible onto server-side gateways between the XMPP network and the non-XMPP network.</li>
  </ol>
  <p class="" style="">Note: The Raw UDP transport does not provide traversal of Network Address Translators (NATs) and is provided only for the purpose of specifying the IP address and port that an entity considers most likely to succeed without the need for NAT traversal. If NAT traversal is needed, <span class="ref" style="">Jingle RTP-ICE Transport Method</span>  [<a href="#nt-id2260047">3</a>] SHOULD be used.</p>
<h2>3.
       <a name="protocol">Protocol Description</a>
</h2>
  <div class="indent">
<h3>3.1 <a name="protocol-initiate">Transport Initiation</a>
</h3>
    <p class="" style="">In order for the initiating entity in a Jingle exchange to start the negotiation, it MUST send a Jingle "session-initiate" stanza as described in <span style="font-weight: bold">XEP-0166</span>. This stanza MUST include at least one transport methods. If the initiating entity wishes to negotiate the Raw UDP transport, it MUST include an empty &lt;transport/&gt; child element qualified by the 'http://jabber.org/protocol/jingle/transport/raw-udp' namespace.</p>
    <a name="example-1"></a><p class="caption">Example 1. Initiation Example</p>
<div class="indent"><pre>
&lt;iq to='juliet@capulet.com/balcony' from='romeo@montague.net/orchard' id='jingle1' type='set'&gt;
  &lt;jingle xmlns='http://jabber.org/protocol/jingle'
          action='session-initiate'
          initiator='romeo@montague.net/orchard'
          sid='a73sjjvkla37jfea'&gt;
    &lt;content name='this-is-the-audio-content'&gt;
      &lt;description ...&gt;
      &lt;transport xmlns='http://jabber.org/protocol/jingle/transport/raw-udp'/&gt;
    &lt;/content&gt;
  &lt;/jingle&gt;
&lt;/iq&gt;
    </pre></div>
  </div>
  <div class="indent">
<h3>3.2 <a name="protocol-response">Receiver Response</a>
</h3>
    <p class="" style="">As described in <span style="font-weight: bold">XEP-0166</span>, to provisionally accept the session initiation request, the receiver returns an IQ-result:</p>
    <a name="example-2"></a><p class="caption">Example 2. Receiver Provisionally Accepts the Session Request</p>
<div class="indent"><pre>
&lt;iq from='juliet@capulet.com/balcony' to='romeo@montague.net/orchard' type='result' id='jingle1'/&gt;
    </pre></div>
  </div>
  <div class="indent">
<h3>3.3 <a name="protocol-addresses">Exchanging Address Information</a>
</h3>
    <p class="" style="">Once the session is provisionally accepted, each entity SHOULD send one &lt;transport/&gt; element in a transport-info meessage, containing exactly one &lt;candidate/&gt; element per content type, whose 'ip' and 'port' attributes specify the IP address and port number of the candidate that the initiator has reason to believe will be most likely to succeed for that content type. This is not necessarily the initiator's preferred address for communication, but instead is the "address most likely to succeed", i.e., the address that is assumed to be reachable by the vast majority of target entities. To determine reachability, the client needs classify ahead of time the permissiveness of the NAT or firewall it is behind, if any. If the NAT is symmetric (not permissive), the candidate SHOULD specify a relay address. Otherwise it SHOULD be an address derived via prior discovery using <span class="ref" style="">RFC 3489</span>  [<a href="#nt-id2260163">4</a>], which will be an address on the outside of the firewall or NAT.</p>
  <p class="" style="">Note: The Raw UDP candidate is equivalent to the "in-use" candidate as described in <span class="ref" style="">Interactive Connectivity Establishment (ICE)</span>  [<a href="#nt-id2260214">5</a>]. (In older versions of XEP-0166, this was referrred to as the "default candidate".)</p>
    <a name="example-3"></a><p class="caption">Example 3. Address Exchange Example</p>
<div class="indent"><pre>
&lt;iq from='romeo@montague.net/orchard' to='juliet@capulet.com/balcony' id='jingle2' type='set'&gt;
  &lt;jingle xmlns='http://jabber.org/protocol/jingle'
          action='transport-info'
          initiator='romeo@montague.net/orchard'
          sid='a73sjjvkla37jfea'&gt;
    &lt;content name='this-is-the-audio-content'&gt;
      &lt;transport xmlns='http://jabber.org/protocol/jingle/transport/raw-udp'&gt;
        &lt;candidate name='myvoicedata' ip='10.1.1.104' port='13540' generation='0'/&gt;
      &lt;/transport&gt;
    &lt;/content&gt;
  &lt;/jingle&gt;
&lt;/iq&gt;
    </pre></div>
    <p class="" style="">The 'generation', 'ip', 'name', and 'port' attributes are REQUIRED. The 'name' attribute specifies the name of the content type and the 'generation' attribute provides a tracking mechanism for determining which version of this candidate is in force (this is useful if the candidate is redefined mid-stream, for example if the port is changed).</p>
    <p class="" style="">Either entity may send this "transport-info" action at any time, after which the recipient should attempt to send media data to the specified address (either entity MAY also send the <a href="#protocol-info">Informational Messages</a> described below). If media data can be delivered for the candidate, the recipient MUST send a Jingle "transport-accept" action to the initiator (either explicitly, or implicitly via a "content-accept" or "session-accept" action.</p>
    <a name="example-4"></a><p class="caption">Example 4. Responder Returns Transport-Accept</p>
<div class="indent"><pre>
&lt;iq from='juliet@capulet.com/balcony' to='romeo@montague.net/orchard' type='set' id='accept1'&gt;
  &lt;jingle xmlns='http://jabber.org/protocol/jingle'
          action='transport-accept'
          initiator='romeo@montague.net/orchard'
          sid='a73sjjvkla37jfea'&gt;
    &lt;content name='this-is-the-audio-content'&gt;
      &lt;transport xmlns='http://jabber.org/protocol/jingle/transport/raw-udp'&gt;
        &lt;candidate name='myvoicedata' ip='10.1.1.104' port='13540' generation='0'/&gt;
      &lt;/transport&gt;
    &lt;/content&gt;
  &lt;/jingle&gt;
  &lt;/jingle&gt;
&lt;/iq&gt;
    </pre></div>
    <p class="" style="">The initiator MUST then acknowledge acceptance by returning an IQ result (or return a standard XMPP error).</p>
  </div>

  <div class="indent">
<h3>3.4 <a name="protocol-info">Informational Messages</a>
</h3>
    <p class="" style="">Informational messages may be sent by the receiver within the context of the Raw UDP transport to communicate the status of transport checking. The informational message MUST be an IQ-set containing a &lt;jingle/&gt; element of type "transport-info", where the informational message is a payload  element qualified by the 'http://jabber.org/protocol/jingle/info/raw-udp' namespace; the following payload elements are defined:</p>
    <p class="caption">Table 1: Information Payload Elements</p>
<table border="1" cellpadding="3" cellspacing="0">
      <tr class="body">
        <th colspan="" rowspan="">Element</th>
        <th colspan="" rowspan="">Meaning</th>
      </tr>
      <tr class="body">
        <td align="" colspan="" rowspan="">&lt;failed/&gt;</td>
        <td align="" colspan="" rowspan="">Connectivity checks failed.</td>
      </tr>
      <tr class="body">
        <td align="" colspan="" rowspan="">&lt;succeeded/&gt;</td>
        <td align="" colspan="" rowspan="">Connectivity checks succeeded.</td>
      </tr>
      <tr class="body">
        <td align="" colspan="" rowspan="">&lt;trying/&gt;</td>
        <td align="" colspan="" rowspan="">Connectivity checks are underway.</td>
      </tr>
    </table>
    <p class="" style="">Note: Because the informational message is sent in an IQ-set, the receiving party MUST return either an IQ-result or an IQ-error (normally only an IQ-result to acknowledge receipt; no error flows are defined or envisioned at this time).</p>
  </div>
<h2>4.
       <a name="security">Security Considerations</a>
</h2>
  <div class="indent">
<h3>4.1 <a name="security-e2e">End-to-End Data Encryption</a>
</h3>
    <p class="" style="">In order to secure the data stream, implementations SHOULD use encryption methods appropriate to the transport method; in the case of UDP, that would include Datagram Transport Layer Security (DTLS) as specified in <span class="ref" style="">RFC 4347</span>  [<a href="#nt-id2260594">6</a>].</p>
  </div>
<h2>5.
       <a name="iana">IANA Considerations</a>
</h2>
  <p class="" style="">This document requires no interaction with the <span class="ref" style="">Internet Assigned Numbers Authority (IANA)</span>  [<a href="#nt-id2260631">7</a>].</p>
<h2>6.
       <a name="registrar">XMPP Registrar Considerations</a>
</h2>
  <div class="indent">
<h3>6.1 <a name="registrar-ns">Protocol Namespaces</a>
</h3>
    <p class="" style="">The <span class="ref" style="">XMPP Registrar</span>  [<a href="#nt-id2260680">8</a>] shall include 'http://jabber.org/protocol/jingle/transport/raw-udp' in its registry of protocol namespaces.</p>
  </div>
  <div class="indent">
<h3>6.2 <a name="registrar-transports">Jingle Transport Methods</a>
</h3>
    <p class="" style="">The XMPP Registrar shall include "http://jabber.org/protocol/jingle/transport/raw-udp" in its registry of Jingle transport methods. The registry submission is as follows:</p>
    <p class="" style="">In order to submit new values to this registry, the registrant must define an XML fragment of the following form and either include it in the relevant XMPP Extension Protocol or send it to the email address &lt;registrar@jabber.org&gt;:</p>
    <p class="caption"></p>
<div class="indent"><pre>
&lt;transport&gt;
  &lt;name&gt;raw-udp&lt;/name&gt;
  &lt;desc&gt;A method for exchanging data over a raw UDP connection.&lt;/desc&gt;
  &lt;doc&gt;XEP-0176&lt;/doc&gt;
&lt;/transport&gt;
    </pre></div>
  </div>
<h2>7.
       <a name="schema">XML Schema</a>
</h2>
  <p class="caption"></p>
<div class="indent"><pre>
&lt;?xml version='1.0' encoding='UTF-8'?&gt;

&lt;xs:schema
    xmlns:xs='http://www.w3.org/2001/XMLSchema'
    targetNamespace='http://jabber.org/protocol/jingle/transport/raw-udp'
    xmlns='http://jabber.org/protocol/jingle/transport/raw-udp'
    elementFormDefault='qualified'&gt;

  &lt;xs:element name='transport'&gt;
    &lt;xs:complexType&gt;
      &lt;xs:sequence&gt;
        &lt;xs:element ref='candidate' minOccurs='0' maxOccurs='1'/&gt;
      &lt;/xs:sequence&gt;
    &lt;/xs:complexType&gt;
  &lt;/xs:element&gt;

  &lt;xs:element name='candidate'&gt;
    &lt;xs:complexType&gt;
      &lt;xs:simpleContent&gt;
        &lt;xs:extension base='empty'&gt;
          &lt;xs:attribute name='generation' type='xs:unsignedByte' use='required'/&gt;
          &lt;xs:attribute name='name' type='xs:string' use='required'/&gt;
          &lt;xs:attribute name='ip' type='xs:string' use='required'/&gt;
          &lt;xs:attribute name='port' type='xs:unsignedShort' use='required'/&gt;
        &lt;/xs:extension&gt;
      &lt;/xs:simpleContent&gt;
    &lt;/xs:complexType&gt;
  &lt;/xs:element&gt;

  &lt;xs:simpleType name='empty'&gt;
    &lt;xs:restriction base='xs:string'&gt;
      &lt;xs:enumeration value=''/&gt;
    &lt;/xs:restriction&gt;
  &lt;/xs:simpleType&gt;

&lt;/xs:schema&gt;
  </pre></div>
<p><hr></p>
<a name="notes"></a><h2>Notes</h2>
<div class="indent">
<p><a name="nt-id2251752">1</a>. XEP-0166: Jingle &lt;<a href="http://www.xmpp.org/extensions/xep-0166.html">http://www.xmpp.org/extensions/xep-0166.html</a>&gt;.</p>
<p><a name="nt-id2259977">2</a>. RFC 768: User Datagram Protocol &lt;<a href="http://www.ietf.org/rfc/rfc0768.txt">http://www.ietf.org/rfc/rfc0768.txt</a>&gt;.</p>
<p><a name="nt-id2260047">3</a>. XEP-0176: Jingle RTP-ICE Transport Method &lt;<a href="http://www.xmpp.org/extensions/xep-0176.html">http://www.xmpp.org/extensions/xep-0176.html</a>&gt;.</p>
<p><a name="nt-id2260163">4</a>. RFC 3489: STUN - Simple Traversal of User Datagram Protocol (UDP) Through Network Address Translators (NATs) &lt;<a href="http://www.ietf.org/rfc/rfc3489.txt">http://www.ietf.org/rfc/rfc3489.txt</a>&gt;.</p>
<p><a name="nt-id2260214">5</a>. Interactive Connectivity Establishment (ICE): A Methodology for Network Address Translator (NAT) Traversal for Offer/Answer Protocols &lt;<a href="http://www.ietf.org/internet-drafts/draft-ietf-mmusic-ice-12.txt">http://www.ietf.org/internet-drafts/draft-ietf-mmusic-ice-12.txt</a>&gt;. Work in progress.</p>
<p><a name="nt-id2260594">6</a>. RFC 4347: Datagram Transport Layer Security &lt;<a href="http://www.ietf.org/rfc/rfc4347.txt">http://www.ietf.org/rfc/rfc4347.txt</a>&gt;.</p>
<p><a name="nt-id2260631">7</a>. The Internet Assigned Numbers Authority (IANA) is the central coordinator for the assignment of unique parameter values for Internet protocols, such as port numbers and URI schemes. For further information, see &lt;<a href="http://www.iana.org/">http://www.iana.org/</a>&gt;.</p>
<p><a name="nt-id2260680">8</a>. The XMPP Registrar maintains a list of reserved protocol namespaces as well as registries of parameters used in the context of XMPP extension protocols approved by the Jabber Software Foundation. For further information, see &lt;<a href="http://www.xmpp.org/registrar/">http://www.xmpp.org/registrar/</a>&gt;.</p>
</div>
<p><hr></p>
<a name="revs"></a><h2>Revision History</h2>
<div class="indent">
<h4>Version 0.3 (2006-10-31)</h4>
<div class="indent">Added informational messages; clarified connectivity checks and acceptance process; mentioned that the Raw UDP candidate is conceptually equivalent to the concept of an in-use candidate from the ICE specification; added reference to RFC 4347. (psa)
    </div>
<h4>Version 0.2 (2006-07-12)</h4>
<div class="indent">Removed candidate element and specified exchange of address information via transport-info messages; clarified usage of name attribute. (se/psa)
    </div>
<h4>Version 0.1 (2006-03-01)</h4>
<div class="indent">Initial version (split from XEP-0166). (psa/jb)
    </div>
</div>
<p><hr></p>
<p>END</p>
</body>
</html>
