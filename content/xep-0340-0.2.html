<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>XEP-0340: COnferences with LIghtweight BRIdging (COLIBRI)</title><link rel="stylesheet" type="text/css" href="xmpp.css" /><link href="prettify.css" type="text/css" rel="stylesheet" /><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" /><script type="text/javascript" src="prettify.js"></script><meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=2.0" /><meta name="DC.Title" content="COnferences with LIghtweight BRIdging (COLIBRI)" /><meta name="DC.Creator" content="Emil Ivov" /><meta name="DC.Creator" content="Lyubomir Marinov" /><meta name="DC.Creator" content="Philipp Hancke" /><meta name="DC.Description" content="This specification defines an XMPP extension that allows&#10;      real-time communications clients to discover and interact with&#10;      conference bridges that provide conference mixing or relaying&#10;      capabilities.&#10;    " /><meta name="DC.Publisher" content="XMPP Standards Foundation" /><meta name="DC.Contributor" content="XMPP Extensions Editor" /><meta name="DC.Date" content="2014-01-08" /><meta name="DC.Type" content="XMPP Extension Protocol" /><meta name="DC.Format" content="XHTML" /><meta name="DC.Identifier" content="XEP-0340" /><meta name="DC.Language" content="en" /><meta name="DC.Rights" content="This XMPP Extension Protocol is copyright &#xA9; 1999 &#x2013; 2017 by the XMPP Standards Foundation (XSF)." /></head><body onload="prettyPrint()"><h1>XEP-0340: COnferences with LIghtweight BRIdging (COLIBRI)</h1><table><tr valign="top"><td><strong>Abstract:</strong></td><td>This specification defines an XMPP extension that allows
      real-time communications clients to discover and interact with
      conference bridges that provide conference mixing or relaying
      capabilities.
    </td></tr><tr valign="top"><td><strong>Authors:</strong></td><td>Emil Ivov, Lyubomir Marinov, Philipp Hancke</td></tr><tr valign="top"><td><strong>Copyright:</strong></td><td>© 1999 – 2017 XMPP Standards Foundation. <a href="#appendix-legal">SEE LEGAL NOTICES</a>.</td></tr><tr valign="top"><td><strong>Status:</strong></td><td>Experimental</td></tr><tr valign="top"><td><strong>Type:</strong></td><td>Standards Track</td></tr><tr valign="top"><td><strong>Version:</strong></td><td>0.1</td></tr><tr valign="top"><td><strong>Last Updated:</strong></td><td>2014-01-08</td></tr></table><hr /><p style="color:red">WARNING: This Standards-Track document is Experimental. Publication as an XMPP Extension Protocol does not imply approval of this proposal by the XMPP Standards Foundation. Implementation of the protocol described herein is encouraged in exploratory implementations, but production systems are advised to carefully consider whether it is appropriate to deploy implementations of this protocol before it advances to a status of Draft.</p><hr /><h2>Table of Contents</h2><div class="indent"><p><br />1.  <a href="#intro">Introduction</a><br />2.  <a href="#terms">Terminology</a><br />3.  <a href="#reqs">Requirements</a><br />4.  <a href="#howitworks">How It Works</a><br />5.  <a href="#usecases">Use cases</a><br />   
      5.1.  <a href="#usecases-create">Creating a conference</a><br />   
      5.2.  <a href="#usecases-update-payload">Updating payload information for a channel</a><br />   
      5.3.  <a href="#usecases-update-transport">Updating transport information for a channel</a><br />   
      5.4.  <a href="#usecases-addchannel">Adding a new channel</a><br />6.  <a href="#support">Determining Support</a><br />7.  <a href="#security">Security Considerations</a><br />8.  <a href="#issues">Open Issues</a><br />9.  <a href="#schema">XML Schemas</a><br />10.  <a href="#acks">Acknowledgements</a></p><p><a href="#appendices">Appendices</a><br />    <a href="#appendix-docinfo">A: Document Information</a><br />    <a href="#appendix-authorinfo">B: Author Information</a><br />    <a href="#appendix-legal">C: Legal Notices</a><br />    <a href="#appendix-xmpp">D: Relation to XMPP</a><br />    <a href="#appendix-discuss">E: Discussion Venue</a><br />    <a href="#appendix-conformance">F: Requirements Conformance</a><br />    <a href="#appendix-notes">G: Notes</a><br />    <a href="#appendix-revs">H: Revision History</a></p></div><hr /><h2>1.
       <a name="intro" id="intro">Introduction</a></h2>
    <p class="" style="">
      <span class="ref" style=""><a href="https://xmpp.org/extensions/xep-0298.html">Delivering Conference Information to Jingle Participants (Coin) (XEP-0298)</a></span>  [<a href="#nt-idm63">1</a>] defines a way for XMPP agents to establish and
      participate in tightly coupled conference calls. Such conference
      calls would typically involve a number of regular participants
      that establish direct one-to-one sessions with a single entity,
      often referred to as a focus agent. Focus agents are generally
      responsible for making sure that media sent from one call
      participant would be distributed to all others so that everyone
      would effectively hear or see everyone else. In other words they
      often act as media mixers.
    </p>

    <p class="" style="">
      Depending on the mixing technology used by media mixers, they may
      require significant bandwidth, processing resources or both. It is
      hence common for mixers to be hosted on dedicated servers that can
      provide such resources. They are then made reachable as
      rendez-vous points and conference call participants are required
      to call in, in order to join a conference call. This requires a
      certain amount of pre-call configuration to be completed by the
      service maintainers in order to create conference rooms and grant
      proper access to the expected participants. The authorization
      credentials are then often relayed to the participants in
      preparation of the call by other means, such as IM or mail.
    </p>

    <p class="" style="">
      In certain situations, such pre-call preparations are
      inconvenient and it is important for users to be able to establish
      ad-hoc conference calls. One way to achieve this is for user
      agents themselves to act as focus agents and media mixers.
      Everyone else just calls the user at the focus agent, who then can
      decide whether to accept or reject the calls as they arrive. This
      works particularly well for audio only calls as the amount of
      bandwidth and processing resources that they require is generally
      within reach for end-user devices.
    </p>

    <p class="" style="">
      The situation is quite different for video calls. Media decoding
      and especially encoding require considerably more resources with
      video than they do with audio. Today, encoding a single video flow
      with an acceptable quality is often the maximum that can be
      expected from an end-user device. The advantages that come with
      Moore's law will likely be insufficient to improve this, given the
      massive shift toward mobile devices and the ever-increasing user
      expectations toward video quality.
    </p>

    <p class="" style="">
      Therefore, this specification (COLIBRI) aims to provide a means
      for user agents to interact with conference mixers. Such
      interaction allows user agents to allocate mixing channels,
      indicate what conferences they should be attached to, what
      integers the various payload types map to, etc. Using COLIBRI
      would hence allow any user agent to organize conference calls and
      act as a signalling focus by outsourcing the actual media mixing
      to a dedicated mixer.
    </p>

  <h2>2.
       <a name="terms" id="terms">Terminology</a></h2>
    <div class="indent"><dl>
      <di>
        <dt><strong>
          Focus or Focus Agent
        </strong></dt>
        <dd>
          The terms apply to XMPP agents that, in terms of signalling,
          stand at the center of a tightly-coupled conference call. In
          other words, all conference participants establish a <span class="ref" style=""><a href="https://xmpp.org/extensions/xep-0166.html">Jingle (XEP-0166)</a></span>  [<a href="#nt-idm76">2</a>]
          session with and only with that agent. Focus Agents are not
          necessarily performing media mixing themselves. In fact, the
          very purpose of this specification is to provide them with a
          means of handling this elsewhere.
        </dd>
      </di>
      <di>
        <dt><strong>
          Mixer or Bridge
        </strong></dt>
        <dd>
          Throughout this document the term is used to depict an
          entity that is responsible for mixing and delivering to
          conference participants all media exchanged in a conference
          call. Mixers or bridges can provide their service by either
          performing Content Mixing, or RTP translation or both.
        </dd>
      </di>
      <di>
        <dt><strong>
          Content Mixing
        </strong></dt>
        <dd>
          The term refers to a kind of media processing where the
          content of multiple input RTP streams is "mixed" into a single
          output stream. In conference calls audio mixing
          implementations generally simply add and adjust all source
          audio streams to produce their single output stream. Video
          content mixing, on the other hand, is often implemented by
          creating composite images containing individual frames from
          the input streams. Another common implementation consists in
          producing an output that is identical to one of the input
          streams, often the one belonging to a currently active
          speaker.
        </dd>
      </di>
      <di>
        <dt><strong>
          RTP Translation
        </strong></dt>
        <dd>
          <span class="ref">RFC 3550</span> defines a translator as "an intermediate
          system that forwards RTP packets with their synchronization
          source identifier intact." This specification respects that
          definition but it also uses "RTP Translation" in opposition
          with "Content Mixing". Conference bridges that perform RTP
          translation simply redirect each incoming RTP packet to all
          participants, often excluding the one where it came from.
          Contrary to content mixing, rtp translation generally requires
          less processing resources since it does not involve media
          manipulation. Bandwidth requirements on the other hand, could
          be significantly higher with RTP translation than with content
          mixing.
        </dd>
      </di>
    </dl></div>
  <h2>3.
       <a name="reqs" id="reqs">Requirements</a></h2>
    <p class="" style="">
      The extension defined herein is designed to meet the following
      requirements:
    </p>
    <ol start="" class="" style="">
      <li class="" style="">
        Provide a means for conference focus agents to interact with
        conference mixers in order to configure payload type mappings
        and allocate ports or other resources that they could then
        advertise in Jingle sessions so that all media would traverse
        the bridge.
      </li>
      <li class="" style="">Impose no COLIBRI specific requirements on non-focus
        participants so that any Jingle supporting client would be able
        to participate.
      </li>
      <li class="" style="">[TODO] Anything else?</li>
    </ol>
  <h2>4.
       <a name="howitworks" id="howitworks">How It Works</a></h2>
    <p class="" style="">
      This section provides a friendly introduction to COLIBRI.
    </p>
    <p class="" style="">
      In essence, the goal of COLIBRI is to provide focus agents with a
      way of using remote mixers as if as they were available locally.
      The most important part of that is the possibility to allocate
      ports on the mixer interfaces and then use these ports when
      establishing Jingle sessions with the various participants.
    </p>
    <p class="" style="">
      Every participant in the conference call is assigned one port for
      RTP data and one for RTCP. An RTP/RTCP port couple is called a
      channel. Each participant would use one channel per media type.
      That is, a client participating with audio only would get one
      channel, while another one that joins with both audio and video
      would get two: one for audio and one for video.
    </p>
    <p class="" style="">
      Channels are used for streams from the bridge to participants and
      from participants to the bridge. Typically a channel would contain
      one stream from a participant to a bridge, for example their
      webcam or desktop, and one or more streams in the opposite
      direction (e.g. webcam or desktop streams from other participants
      to the one using this channel). This is not a requirement though
      and a channel can certainly be used for transportation of multiple
      streams in both directions in cases where one bridge is connected
      to another.
    </p>
    <p class="" style="">
      Typically channels would be created by the entity controlling a
      conference call. This could either be a conferencing server or a
      smart client capable of handling conferences. We would refer to
      both of these as the "focus". In either case, the important part
      is that the focus terminates all signalling. It is a signalling
      endpoint and it is responsible for all aspects of call signalling
      including offer/answer.
    </p>
    <p class="" style="">
      In other words, when setting up a conference, a focus would first
      allocate the necessary channels, then directly initiate sessions
      (invite) other participants into the call. Only, when sending the
      invitations to these participants, the focus would use the
      transport information (addresses and ports) that it would have
      received from the COLIBRI bridge, rather than its own.
    </p>
    
  <h2>5.
       <a name="usecases" id="usecases">Use cases</a></h2>
    <div class="indent"><h3>5.1 <a name="usecases-create" id="usecases-create">Creating a conference</a></h3>
      <p class="" style="">
        The most important thing about setting up a conference is the
        creation of channels for every participant. Conference setup is
        not the only chance an organiser gets to declare all
        participants but typically when a conference call is setup it
        is because there are at least some number of known participants
        and there would be no point in delaying channel creation for
        them.
      </p>
      <p class="" style="">
        The following example shows how Romeo creates an audio/video
        conference at a bridge, requesting that three participant
        channels be created.
      </p>
      <p class="caption"><a name="example-1" id="example-1"></a>Example 1. Creating a conference</p><div class="indent"><pre class="prettyprint">
SEND: &lt;iq from='romeo@montague.lit/orchard'
          id='zid615d9'
          to='garden.montague.lit'
          type='set'&gt;
        &lt;conference xmlns='http://jitsi.org/protocol/colibri'&gt;
          &lt;content name='audio'&gt;
            &lt;channel initiator='true'&gt;
              [optional payload and transport description]
            &lt;/channel&gt;
            &lt;channel initiator='true'/&gt;
            ...
            &lt;channel initiator='true'/&gt;
          &lt;/content&gt;
          &lt;content name='video'&gt;
            &lt;channel initiator='true'/&gt;
            ...
            &lt;channel initiator='true'/&gt;
          &lt;/content&gt;
        &lt;/conference&gt;
      &lt;/iq&gt;
</pre></div>
      <p class="" style="">
        Notice how the 'initiator' channel above is set to true. The
        setting determines ICE and DTLS/SRTP behaviour for the bridge.
        In this specific case, 'initiator' being set to 'true' Romeo is
        requesting that the bridge behave as the initiator of the
        session which means that it would try to be the controlling ICE
        agent and also assume the 'dtls-actpass' role for DTLS/SRTP
        negotiation. A value of 'false' would have meant that the bridge
        would behave as the controlled ICE agent and assume the
        'dtls-active' role.
      </p>
      <p class="" style="">
        When sending its result back, the bridge confirms creation of
        the requested channels and it also delivers transport
        information that would be necessary for participants to
        transport media to the bridge. These would most often include
        ICE candidates, ufrag and pwd parameters, and DTLS fingerprints.
      </p>
      <p class="" style="">
        Note that ICE is not mandatory for use and COLIBRI bridges can
        just as well perform Hosted NAT Traversal using latching and a
        RAW-UDP transport.
      </p>
      <p class="caption"><a name="example-2" id="example-2"></a>Example 2. Result</p><div class="indent"><pre class="prettyprint">
RECV: &lt;iq type='result' to='romeo@montague.lit/orchard'
          from='garden.montague.lit'
          id='zid615d9'&gt;
        &lt;conference xmlns='http://jitsi.org/protocol/colibri'
            id='cafb6f2c8197818e'&gt;
          &lt;content name='audio'&gt;
            &lt;channel rtp-level-relay-type='mixer' direction='recvonly'
                initiator='true' id='c6a142b7cf728fd0' expire='60'&gt;
              &lt;source xmlns='urn:xmpp:jingle:apps:rtp:ssma:0' ssrc='3716204482'/&gt;
              &lt;transport xmlns='urn:xmpp:jingle:transports:ice-udp:1'
                  pwd='5d0mj' ufrag='amiq'&gt;
                &lt;fingerprint xmlns='urn:xmpp:jingle:apps:dtls:0' hash='sha-1'&gt;
                  99:...:F6
                &lt;/fingerprint&gt;
                &lt;candidate type='host' protocol='udp' id='ca' ip='10.0.1.1'
                    component='1' port='5144' foundation='3' generation='0'
                    priority='2113932031' network='0'/&gt;
                &lt;candidate type='host' protocol='udp' id='ga' ip='10.0.1.1'
                    component='2' port='5145' foundation='3' generation='0'
                    priority='2113932030' network='0'/&gt;
              &lt;/transport&gt;
            &lt;/channel&gt;
            ...
          &lt;/content&gt;
          &lt;content name='video'&gt;
            &lt;channel rtp-level-relay-type='mixer' direction='recvonly'
                initiator='true' id='c9726594ccb4ede7' expire='60'&gt;
              ...
            &lt;/channel&gt;
            ...
          &lt;/content&gt;
        &lt;/conference&gt;
      &lt;/iq&gt;
</pre></div>
      <p class="" style="">
        The above "result" also contains the following elements of
        interest for every channel:
      </p>
      <p class="" style="">
        - an ID that is necessary for any further modification from that
        the focus wants to set on a channel. [FIXME: clients should be
        able to specify these id-s so as not to rely on ordering to
        identify channels and get complexes thinking they are SDP
        parsers]
      </p>
      <p class="" style="">
        - an rtp-level-relay-type attribute with possible values of
        'mixer' and 'translator' indicating how the bridge is going to
        deliver data on a specific channel [FIXME: this would definitely
        need to be specifiable from the client].
      </p>
      <p class="" style="">
        - mixer channels would also include ssrc-s for that channels in
        question. This is particularly necessary when SSRC-s need to be
        announced to participants (because people never learned how RTP
        works and are afraid from anything that wasn't explicitly
        announced with an Offer/Answer exchange). Generally such
        announcements would be possible by simply propagating SSRCs that
        other participants announce. In a mixed flow however the SSRC
        would belong to the mixer (or COLIBRI bridge) so it would need
        to be known in advance.
        attribute
      </p>
      <p class="" style="">
        - the initiator value is echoed
      </p>
      <p class="" style="">
        - expire describes how many seconds the bridge will keep the
        channel open without media activity
      </p>
    </div>
    <div class="indent"><h3>5.2 <a name="usecases-update-payload" id="usecases-update-payload">Updating payload information for a channel</a></h3>
      <p class="" style="">
        Channel updates can happen for various reasons. The following
        examples illustrate two of them:
      </p>
      <p class="" style="">
        - specifying payload types. While payload types in RTP are
        sometimes static (e.g. for older codecs such as G.711), this is
        not always the case for more recent types, which need to be
        assigned dynamically during session establishment. The tricky
        part here is that dynamic means dynamic so every participant in
        a conference call may end up expecting different payload types.
        As a result, a COLIBRI bridge SHOULD know about everyone's
        expectations, which is why channels are updated with payload
        types. Note that if a bridge does see unknown payload types it
        MUST still relay them to other participants as they might have
        used some other mechanism to make sure they know what they
        mean.
      </p>
      <p class="" style="">
        - DTLS/SRTP fingerprints.
      </p>
      <p class="caption"><a name="example-3" id="example-3"></a>Example 3. Focus updates payload information for a channel</p><div class="indent"><pre class="prettyprint">
        
SEND: &lt;iq to='garden.montague.lit' from='romeo@montague.lit/orchard'
          type='set' id='74s'&gt;
        &lt;conference xmlns='http://jitsi.org/protocol/colibri'
            id='cafb6f2c8197818e'&gt;
          &lt;content name='audio'&gt;
            &lt;channel id='c6a142b7cf728fd0' initiator='true'&gt;
              &lt;payload-type id='111' name='opus' clockrate='48000' channels='2'/&gt;
              &lt;payload-type id='0' name='PCMU' clockrate='8000' channels='1'/&gt;
              &lt;payload-type id='8' name='PCMA' clockrate='8000' channels='1'/&gt;
              &lt;transport xmlns='urn:xmpp:jingle:transports:ice-udp:1'
                  ufrag='WP+qAQZGnDhhM+87' pwd='0Uxdzy9gTryxAkmAx2LD1TYR'&gt;
                &lt;fingerprint hash='sha-256' xmlns='urn:xmpp:jingle:apps:dtls:0'
                    setup='active'&gt;
                  08:...:C7
                &lt;/fingerprint&gt;
              &lt;/transport&gt;
            &lt;/channel&gt;
          &lt;/content&gt;
          &lt;content name='video'&gt;
            &lt;channel id='c9726594ccb4ede7' initiator='true'&gt;
              &lt;payload-type id='100' name='VP8' clockrate='90000' channels='1'/&gt;
              &lt;payload-type id='116' name='red' clockrate='90000' channels='1'/&gt;
              &lt;payload-type id='117' name='ulpfec' clockrate='90000' channels='1'/&gt;
              &lt;transport xmlns='urn:xmpp:jingle:transports:ice-udp:1'
                  ufrag='hpx55NAN46sNYwF+' pwd='hkg/YRpjXZx4qDG3KbzB3qr1'&gt;
                &lt;fingerprint hash='sha-256' xmlns='urn:xmpp:jingle:apps:dtls:0'
                    setup='active'&gt;
                  08:...:C7
                &lt;/fingerprint&gt;
              &lt;/transport&gt;
            &lt;/channel&gt;
          &lt;/content&gt;
        &lt;/conference&gt;
      &lt;/iq&gt;
</pre></div>
      <p class="" style="">
        Note that while the result in this case is essentially an
        acknowledgement, it still carries a full representation of the
        bridge.
      </p>
      <p class="caption"><a name="example-4" id="example-4"></a>Example 4. Result</p><div class="indent"><pre class="prettyprint">
RECV: &lt;iq to='romeo@montague.lit/orchard' from='garden.montague.lit'
          type='result' id='74s'&gt;
        &lt;conference xmlns='http://jitsi.org/protocol/colibri'
            id='cafb6f2c8197818e'&gt;
          &lt;content name='audio'&gt;
            &lt;channel rtp-level-relay-type='mixer' direction='recvonly'
                initiator='true' id='c6a142b7cf728fd0' expire='60'&gt;
              &lt;transport xmlns='urn:xmpp:jingle:transports:ice-udp:1'
                  pwd='5d0mj' ufrag='amiq'&gt;
                &lt;fingerprint xmlns='urn:xmpp:jingle:apps:dtls:0' hash='sha-1'&gt;
                  99:...:F6
                &lt;/fingerprint&gt;
                &lt;candidate type='host' protocol='udp' id='ca' ip='10.0.1.1' component='1'
                    port='5144' foundation='3' generation='0' priority='2113932031'
                    network='0'/&gt;
                &lt;candidate type='host' protocol='udp' id='ga' ip='10.0.1.1' component='2'
                    port='5145' foundation='3' generation='0' priority='2113932030'
                    network='0'/&gt;
              &lt;/transport&gt;
            &lt;/channel&gt;
            ...
          &lt;/content&gt;
          &lt;content name='video'&gt;
            &lt;channel rtp-level-relay-type='translator' initiator='true'
                id='c9726594ccb4ede7' expire='60'&gt;
              ...
            &lt;/channel&gt;
            ...
          &lt;/content&gt;
        &lt;/conference&gt;
      &lt;/iq&gt;
</pre></div>
    </div>
    <div class="indent"><h3>5.3 <a name="usecases-update-transport" id="usecases-update-transport">Updating transport information for a channel</a></h3>
      <p class="caption"><a name="example-5" id="example-5"></a>Example 5. Result</p><div class="indent"><pre class="prettyprint">
SEND: &lt;iq to='garden.montague.lit' from='romeo@montague.lit/orchard'
          type='set' id='1581'&gt;
        &lt;conference xmlns='http://jitsi.org/protocol/colibri' id='cafb6f2c8197818e'&gt;
          &lt;content name='audio'&gt;
            &lt;channel id='c6a142b7cf728fd0' initiator='true'&gt;
              &lt;transport xmlns='urn:xmpp:jingle:transports:ice-udp:1'&gt;
                &lt;candidate foundation='2241210590' component='1' protocol='udp'
                    priority='2113937151' ip='192.168.2.101' port='61141' type='host'
                    generation='0' network='1' id='1234'/&gt;
              &lt;/transport&gt;
            &lt;/channel&gt;
          &lt;/content&gt;
        &lt;/conference&gt;
      &lt;/iq&gt;
</pre></div>

      <p class="caption"><a name="example-6" id="example-6"></a>Example 6. Result</p><div class="indent"><pre class="prettyprint">
RECV: &lt;iq type='result' to='romeo@montague.lit/orchard' from='garden.montague.lit' id='1581'&gt;
        &lt;conference xmlns='http://jitsi.org/protocol/colibri' id='cafb6f2c8197818e'&gt;
          &lt;content name='audio'&gt;
            &lt;channel rtp-level-relay-type='translator' initiator='true'
                id='c6a142b7cf728fd0' expire='60'&gt;
              &lt;transport xmlns='urn:xmpp:jingle:transports:ice-udp:1'
                  pwd='5d0mja27fgl83r9tsl1b9gkk4f' ufrag='amiqp'&gt;
                &lt;fingerprint xmlns='urn:xmpp:jingle:apps:dtls:0' hash='sha-1'&gt;
                  99:..:F6
                &lt;/fingerprint&gt;
                &lt;candidate type='host' protocol='udp' id='1' ip='10.0.1.1' component='1'
                    port='5144' foundation='3' generation='0' priority='2113932031' network='0'/&gt;
                &lt;candidate type='host' protocol='udp' id='2' ip='10.0.1.1' component='2'
                    port='5145' foundation='3' generation='0' priority='2113932030' network='0'/&gt;
              &lt;/transport&gt;
            &lt;/channel&gt;
          &lt;/content&gt;
        &lt;/conference&gt;
      &lt;/iq&gt;
</pre></div>
      <p class="" style="">Essentially that information is the transport description from
        the bridge. 
      </p>
    </div>
    <div class="indent"><h3>5.4 <a name="usecases-addchannel" id="usecases-addchannel">Adding a new channel</a></h3>
      <p class="" style="">
        ICE candidates are another reason why a focus might want to
        update a channel. Earlier examples indicated how conference
        setup could be completed without providing any transport
        information whatsoever. Whenever that is the case, such
        information would need to be provided through channel
        modification.
      </p>
      <p class="caption"><a name="example-7" id="example-7"></a>Example 7. Adding a new channel</p><div class="indent"><pre class="prettyprint">
SEND: &lt;iq to='garden.montague.lit' from='romeo@montague.lit/orchard' type='get' id='247'&gt;
        &lt;conference xmlns='http://jitsi.org/protocol/colibri' id='cafb6f2c8197818e'&gt;
          &lt;content creator='initiator' name='audio'&gt;
            &lt;channel initiator='true'/&gt;
          &lt;/content&gt;
          &lt;content creator='initiator' name='video'&gt;
            &lt;channel initiator='true'/&gt;
          &lt;/content&gt;
        &lt;/conference&gt;
      &lt;/iq&gt;
</pre></div>
      <p class="caption"><a name="example-8" id="example-8"></a>Example 8. Result</p><div class="indent"><pre class="prettyprint">
RECV: &lt;iq type='result' to='romeo@montague.lit/orchard' from='garden.montague.lit' id='247'&gt;
        &lt;conference xmlns='http://jitsi.org/protocol/colibri' id='49a91b4f6694bc6a'&gt;
          &lt;content name='audio'&gt;
            &lt;channel rtp-level-relay-type='mixer' direction='recvonly' initiator='true'
                id='e97d7f794fbed74b' expire='60'&gt;
              &lt;source xmlns='urn:xmpp:jingle:apps:rtp:ssma:0' ssrc='2579640556'/&gt;
              &lt;transport xmlns='urn:xmpp:jingle:transports:ice-udp:1'
                  pwd='75e88spurhqbih628ord5a3l9b' ufrag='6c7a6'&gt;
                &lt;fingerprint xmlns='urn:xmpp:jingle:apps:dtls:0' hash='sha-1'&gt;
                  A9:...:2F
                &lt;/fingerprint&gt;
                &lt;candidate type='host' protocol='udp' id='1' ip='10.0.1.1' component='1'
                    port='5168' foundation='3' generation='0' priority='2113932031'
                    network='0'/&gt;
                &lt;candidate type='host' protocol='udp' id='2' ip='10.0.1.1' component='2'
                    port='5169' foundation='3' generation='0' priority='2113932030'
                    network='0'/&gt;
              &lt;/transport&gt;
            &lt;/channel&gt;
          &lt;/content&gt;
          &lt;content name='video'&gt;
            &lt;channel rtp-level-relay-type='translator' initiator='true'
                id='b4557f274216f99a' expire='60'&gt;
              &lt;transport xmlns='urn:xmpp:jingle:transports:ice-udp:1'
                  pwd='1oriuuhjfq6884ln9d3g1rjq13' ufrag='3gh3o'&gt;
                &lt;fingerprint xmlns='urn:xmpp:jingle:apps:dtls:0' hash='sha-1'&gt;
                  D7:...:C2
                &lt;/fingerprint&gt;
                &lt;candidate type='host' protocol='udp' id='1' ip='10.0.1.1' component='1'
                    port='5170' foundation='3' generation='0' priority='2113932031'
                    network='0'/&gt;
                &lt;candidate type='host' protocol='udp' id='2' ip='10.0.1.1' component='2'
                    port='5171' foundation='3' generation='0' priority='2113932030'
                    network='0'/&gt;
              &lt;/transport&gt;
            &lt;/channel&gt;
          &lt;/content&gt;
        &lt;/conference&gt;
      &lt;/iq&gt;
</pre></div>
    </div>
  <h2>6.
       <a name="support" id="support">Determining Support</a></h2>
    <p class="" style="">If an entity supports COLIBRI, it SHOULD advertise that fact by
      returning
      a feature of "http://jitsi.org/protocol/colibri" in response to
      a <span class="ref" style=""><a href="https://xmpp.org/extensions/xep-0030.html">Service Discovery (XEP-0030)</a></span>  [<a href="#nt-idm135">3</a>]
      information request.
    </p>
    <p class="caption"><a name="example-9" id="example-9"></a>Example 9. Service Discovery Information Request</p><div class="indent"><pre class="prettyprint">
&lt;iq from='kingclaudius@shakespeare.lit/castle'
    id='ku6e51v3'
    to='belfry.shakespeare.lit'
    type='get'&gt;
  &lt;query xmlns='http://jabber.org/protocol/disco#info'/&gt;
&lt;/iq&gt;
</pre></div>
    <p class="caption"><a name="example-10" id="example-10"></a>Example 10. Service Discovery Information Response</p><div class="indent"><pre class="prettyprint">
&lt;iq from='belfry.shakespeare.lit'
    id='ku6e51v3'
    to='kingclaudius@shakespeare.lit/castle'
    type='result'&gt;
  &lt;query xmlns='http://jabber.org/protocol/disco#info'&gt;
    &lt;feature var='http://jitsi.org/protocol/colibri'/&gt;
  &lt;/query&gt;
&lt;/iq&gt;
</pre></div>
    <p class="" style="">In order for an application to determine whether an entity
      supports this
      protocol, where possible it SHOULD use the dynamic, presence-based
      profile
      of service discovery defined in <span class="ref" style=""><a href="https://xmpp.org/extensions/xep-0115.html">Entity Capabilities (XEP-0115)</a></span>  [<a href="#nt-idm142">4</a>]. However, if an
      application has
      not received entity capabilities information from an entity, it
      SHOULD use
      explicit service discovery instead.
    </p>
  <h2>7.
       <a name="security" id="security">Security Considerations</a></h2>
    <p class="" style="">PENDING</p>
  <h2>8.
       <a name="issues" id="issues">Open Issues</a></h2>
    <p class="" style="">PENDING</p>
  <h2>9.
       <a name="schema" id="schema">XML Schemas</a></h2>
    <p class="" style="">PENDING</p>
  <h2>10.
       <a name="acks" id="acks">Acknowledgements</a></h2>
    <p class="" style="">Jitsi's participation in this specification is funded by the
      NLnet
      Foundation.
    </p>
  <hr /><a name="appendices" id="appendices"></a><h2>Appendices</h2><hr /><a name="appendix-docinfo" id="appendix-docinfo"></a><h3>Appendix A: Document Information</h3><p class="indent">
            Series: <a href="http://xmpp.org/extensions/">XEP</a><br />
            Number: 0340<br />
            Publisher: <a href="/xsf/">XMPP Standards Foundation</a><br />
            Status:
            <a href="http://xmpp.org/extensions/xep-0001.html#states-Experimental">Experimental</a><br />
            Type:
            <a href="http://xmpp.org/extensions/xep-0001.html#types-Standards Track">Standards Track</a><br />
            Version: 0.1<br />
            Last Updated: 2014-01-08<br />
                Approving Body: <a href="http://xmpp.org/council/">XMPP Council</a><br />Dependencies: XEP-0167<br />
                Supersedes: None<br />
                Superseded By: None<br />
            Short Name: colibri<br />
              Source Control:
                <a class="standardsButton" href="https://github.com/xsf/xeps/blob/master/xep-0340.xml">HTML</a><br />
            This document in other formats:
                <a class="standardsButton" href="http://xmpp.org/extensions/xep-0340.xml">XML</a> 
                <a class="standardsButton" href="http://xmpp.org/extensions/xep-0340.pdf">PDF</a></p><hr /><a name="appendix-authorinfo" id="appendix-authorinfo"></a><h3>Appendix B: Author Information</h3><div class="indent"><h3>Emil Ivov</h3><p class="indent">
        Organization: jitsi.org<br />
        Email:
        <a href="mailto:emcho@jitsi.org">emcho@jitsi.org</a><br />
        JabberID:
        <a href="xmpp:emcho@sip-communicator.org">emcho@sip-communicator.org</a><br /></p><h3>Lyubomir Marinov</h3><p class="indent">
        Organization: jitsi.org<br />
        Email:
        <a href="mailto:lubo@jitsi.org">lubo@jitsi.org</a><br />
        JabberID:
        <a href="xmpp:lubo@sip-communicator.org">lubo@sip-communicator.org</a><br /></p><h3>Philipp Hancke</h3><p class="indent">
        Email:
        <a href="mailto:fippo@andyet.com">fippo@andyet.com</a><br />
        JabberID:
        <a href="xmpp:fippo@goodadvice.pages.de">fippo@goodadvice.pages.de</a><br /></p></div><hr /><a name="appendix-legal" id="appendix-legal"></a><h3>Appendix C: Legal Notices</h3><div class="indent"><h4>Copyright</h4>This XMPP Extension Protocol is copyright © 1999 – 2017 by the <a href="https://xmpp.org/">XMPP Standards Foundation</a> (XSF).<h4>Permissions</h4>Permission is hereby granted, free of charge, to any person obtaining a copy of this specification (the "Specification"), to make use of the Specification without restriction, including without limitation the rights to implement the Specification in a software program, deploy the Specification in a network service, and copy, modify, merge, publish, translate, distribute, sublicense, or sell copies of the Specification, and to permit persons to whom the Specification is furnished to do so, subject to the condition that the foregoing copyright notice and this permission notice shall be included in all copies or substantial portions of the Specification. Unless separate permission is granted, modified works that are redistributed shall not contain misleading information regarding the authors, title, number, or publisher of the Specification, and shall not claim endorsement of the modified works by the authors, any organization or project to which the authors belong, or the XMPP Standards Foundation.<h4>Disclaimer of Warranty</h4><span style="font-weight: bold">## NOTE WELL: This Specification is provided on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, express or implied, including, without limitation, any warranties or conditions of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A PARTICULAR PURPOSE. ##</span><h4>Limitation of Liability</h4>In no event and under no legal theory, whether in tort (including negligence), contract, or otherwise, unless required by applicable law (such as deliberate and grossly negligent acts) or agreed to in writing, shall the XMPP Standards Foundation or any author of this Specification be liable for damages, including any direct, indirect, special, incidental, or consequential damages of any character arising from, out of, or in connection with the Specification or the implementation, deployment, or other use of the Specification (including but not limited to damages for loss of goodwill, work stoppage, computer failure or malfunction, or any and all other commercial damages or losses), even if the XMPP Standards Foundation or such author has been advised of the possibility of such damages.<h4>IPR Conformance</h4>This XMPP Extension Protocol has been contributed in full conformance with the XSF's Intellectual Property Rights Policy (a copy of which can be found at &lt;<a href="https://xmpp.org/about/xsf/ipr-policy">https://xmpp.org/about/xsf/ipr-policy</a>&gt; or obtained by writing to XMPP Standards Foundation, P.O. Box 787, Parker, CO 80134 USA).</div><hr /><a name="appendix-xmpp" id="appendix-xmpp"></a><h3>Appendix D: Relation to XMPP</h3><p class="indent">The Extensible Messaging and Presence Protocol (XMPP) is defined in the XMPP Core (RFC 6120) and XMPP IM (RFC 6121) specifications contributed by the XMPP Standards Foundation to the Internet Standards Process, which is managed by the Internet Engineering Task Force in accordance with RFC 2026. Any protocol defined in this document has been developed outside the Internet Standards Process and is to be understood as an extension to XMPP rather than as an evolution, development, or modification of XMPP itself.</p><hr /><a name="appendix-discuss" id="appendix-discuss"></a><h3>Appendix E: Discussion Venue</h3><p class="indent">There exists a special venue for discussion related to the technology described in this document: the &lt;<a href="http://mail.jabber.org/mailman/listinfo/jingle">jingle@xmpp.org</a>&gt; mailing list.</p><p class="indent">The primary venue for discussion of XMPP Extension Protocols is the &lt;<a href="http://mail.jabber.org/mailman/listinfo/standards">standards@xmpp.org</a>&gt; discussion list.</p><p class="indent">Discussion on other xmpp.org discussion lists might also be appropriate; see &lt;<a href="http://xmpp.org/about/discuss.shtml">http://xmpp.org/about/discuss.shtml</a>&gt; for a complete list.</p><p class="indent">Errata can be sent to &lt;<a href="mailto:editor@xmpp.org">editor@xmpp.org</a>&gt;.</p><hr /><a name="appendix-conformance" id="appendix-conformance"></a><h3>Appendix F: Requirements Conformance</h3><p class="indent">The following requirements keywords as used in this document are to be interpreted as described in <a href="http://www.ietf.org/rfc/rfc2119.txt">RFC 2119</a>: "MUST", "SHALL", "REQUIRED"; "MUST NOT", "SHALL NOT"; "SHOULD", "RECOMMENDED"; "SHOULD NOT", "NOT RECOMMENDED"; "MAY", "OPTIONAL".</p><hr /><a name="appendix-notes" id="appendix-notes"></a><h3>Appendix G: Notes</h3><div class="indent"><p><a name="nt-idm63" id="nt-idm63">1</a>. XEP-0298: Delivering Conference Information to Jingle Participants (Coin) &lt;<a href="https://xmpp.org/extensions/xep-0298.html">https://xmpp.org/extensions/xep-0298.html</a>&gt;.</p><p><a name="nt-idm76" id="nt-idm76">2</a>. XEP-0166: Jingle &lt;<a href="https://xmpp.org/extensions/xep-0166.html">https://xmpp.org/extensions/xep-0166.html</a>&gt;.</p><p><a name="nt-idm135" id="nt-idm135">3</a>. XEP-0030: Service Discovery &lt;<a href="https://xmpp.org/extensions/xep-0030.html">https://xmpp.org/extensions/xep-0030.html</a>&gt;.</p><p><a name="nt-idm142" id="nt-idm142">4</a>. XEP-0115: Entity Capabilities &lt;<a href="https://xmpp.org/extensions/xep-0115.html">https://xmpp.org/extensions/xep-0115.html</a>&gt;.</p></div><hr /><a name="appendix-revs" id="appendix-revs"></a><h3>Appendix H: Revision History</h3><p>Note: Older versions of this specification might be available at <a href="http://xmpp.org/extensions/attic/">http://xmpp.org/extensions/attic/</a></p><div class="indent"><h4>Version 0.1 (2014-01-08)</h4><div class="indent"><p class="" style="">Initial published version approved by the XMPP Council.</p> (psa)
    </div><h4>Version 0.0.2 (2013-12-04)</h4><div class="indent">
        <p class="" style="">Added usecases.</p>
       (ei/ph)
    </div><h4>Version 0.0.1 (2013-05-30)</h4><div class="indent">
        <p class="" style="">First draft.</p>
       (ei/lm)
    </div></div><hr /><p>END</p></body></html>
